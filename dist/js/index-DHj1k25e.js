import{j as e}from"./index-DuFe5DRh.js";import{r as s}from"./react-vendor-BSBC8BLg.js";import{$ as i,c as t,d as r,a as l,Q as a,x as n,J as d,am as o,S as c,a3 as m,a4 as h,B as x,b4 as p,V as u,O as j,a1 as g,ac as y,aI as v,az as w,X as f,b5 as I,ad as S,W as b,a5 as C,b6 as T,a6 as k,au as A,ao as z,b7 as D,l as Z,T as L,s as P,A as N,b8 as q,b9 as O,ag as Y,ah as M,ai as F,ba as B,bb as $,bc as E,ak as U,al as R}from"./antd-vendor-BuqAAsAf.js";const{Option:_}=h,{TextArea:K}=m,{TabPane:H}=o,{Panel:V}=v,{Text:J,Title:Q,Paragraph:W}=L,{TreeNode:X}=A,G=()=>{var L,W,X;const[G,ee]=s.useState([]),[se,ie]=s.useState([]),[te,re]=s.useState([]),[le,ae]=s.useState(!1),[ne,de]=s.useState(!1),[oe,ce]=s.useState(!1),[me,he]=s.useState(!1),[xe,pe]=s.useState(!1),[ue,je]=s.useState(null),[ge,ye]=s.useState(null),[ve,we]=s.useState(null),[fe]=i.useForm(),[Ie]=i.useForm(),[Se,be]=s.useState(""),[Ce,Te]=s.useState(""),[ke,Ae]=s.useState(""),[ze,De]=s.useState("users");s.useEffect(()=>{(async()=>{ae(!0);try{await new Promise(e=>setTimeout(e,500)),ee([{id:"1",username:"admin",email:"admin@seqnice.com",fullName:"系统管理员",phone:"13800138001",avatar:"",status:"active",roleId:"1",roleName:"超级管理员",department:"技术部",position:"系统管理员",employeeId:"EMP001",hireDate:"2023-01-01",lastLoginTime:"2024-02-15T09:30:00Z",loginCount:256,isOnline:!0,permissions:["user:read","user:write","user:delete","role:read","role:write","role:delete"],preferences:{language:"zh-CN",theme:"light",timezone:"Asia/Shanghai"},createdAt:"2023-01-01T00:00:00Z",updatedAt:"2024-02-15T09:30:00Z"},{id:"2",username:"lisi",email:"lisi@seqnice.com",fullName:"李四",phone:"13800138002",avatar:"",status:"active",roleId:"2",roleName:"项目经理",department:"研发部",position:"高级项目经理",employeeId:"EMP002",hireDate:"2023-03-15",lastLoginTime:"2024-02-14T16:45:00Z",loginCount:189,isOnline:!1,permissions:["project:read","project:write","sample:read","sample:write","report:read"],preferences:{language:"zh-CN",theme:"light",timezone:"Asia/Shanghai"},createdAt:"2023-03-15T00:00:00Z",updatedAt:"2024-02-14T16:45:00Z"},{id:"3",username:"wangwu",email:"wangwu@seqnice.com",fullName:"王五",phone:"13800138003",avatar:"",status:"active",roleId:"3",roleName:"生信分析师",department:"生信部",position:"高级生信分析师",employeeId:"EMP003",hireDate:"2023-06-01",lastLoginTime:"2024-02-15T08:20:00Z",loginCount:145,isOnline:!0,permissions:["analysis:read","analysis:write","experiment:read","report:read","report:write"],preferences:{language:"zh-CN",theme:"dark",timezone:"Asia/Shanghai"},createdAt:"2023-06-01T00:00:00Z",updatedAt:"2024-02-15T08:20:00Z"},{id:"4",username:"zhaoliu",email:"zhaoliu@seqnice.com",fullName:"赵六",phone:"13800138004",avatar:"",status:"inactive",roleId:"4",roleName:"实验员",department:"实验部",position:"实验技术员",employeeId:"EMP004",hireDate:"2023-09-10",lastLoginTime:"2024-01-20T14:30:00Z",loginCount:67,isOnline:!1,permissions:["experiment:read","experiment:write","sample:read"],preferences:{language:"zh-CN",theme:"light",timezone:"Asia/Shanghai"},createdAt:"2023-09-10T00:00:00Z",updatedAt:"2024-01-20T14:30:00Z"}])}catch(e){P.error("获取用户列表失败")}finally{ae(!1)}})(),(async()=>{ie([{id:"1",name:"超级管理员",code:"super_admin",description:"系统超级管理员，拥有所有权限",level:1,isSystem:!0,status:"active",userCount:1,permissions:["user:read","user:write","user:delete","role:read","role:write","role:delete","permission:read","permission:write","permission:delete","project:read","project:write","project:delete","sample:read","sample:write","sample:delete","experiment:read","experiment:write","experiment:delete","analysis:read","analysis:write","analysis:delete","report:read","report:write","report:delete","archive:read","archive:write","archive:delete","system:read","system:write","system:delete"],createdAt:"2023-01-01T00:00:00Z",updatedAt:"2023-01-01T00:00:00Z"},{id:"2",name:"项目经理",code:"project_manager",description:"项目管理人员，负责项目全流程管理",level:2,isSystem:!1,status:"active",userCount:3,permissions:["project:read","project:write","sample:read","sample:write","experiment:read","analysis:read","report:read","report:write","archive:read"],createdAt:"2023-01-01T00:00:00Z",updatedAt:"2023-01-01T00:00:00Z"},{id:"3",name:"生信分析师",code:"bioinformatics_analyst",description:"生物信息学分析人员，负责数据分析和报告生成",level:3,isSystem:!1,status:"active",userCount:5,permissions:["analysis:read","analysis:write","experiment:read","report:read","report:write","archive:read"],createdAt:"2023-01-01T00:00:00Z",updatedAt:"2023-01-01T00:00:00Z"},{id:"4",name:"实验员",code:"lab_technician",description:"实验室技术人员，负责样本处理和实验操作",level:4,isSystem:!1,status:"active",userCount:8,permissions:["experiment:read","experiment:write","sample:read","sample:write","archive:read"],createdAt:"2023-01-01T00:00:00Z",updatedAt:"2023-01-01T00:00:00Z"},{id:"5",name:"访客",code:"guest",description:"访客用户，只能查看基本信息",level:5,isSystem:!1,status:"active",userCount:2,permissions:["project:read","sample:read","report:read"],createdAt:"2023-01-01T00:00:00Z",updatedAt:"2023-01-01T00:00:00Z"}])})(),(async()=>{re([{id:"1",name:"查看用户",code:"user:read",module:"user",description:"查看用户列表和详情"},{id:"2",name:"创建用户",code:"user:write",module:"user",description:"创建和编辑用户信息"},{id:"3",name:"删除用户",code:"user:delete",module:"user",description:"删除用户账号"},{id:"4",name:"查看角色",code:"role:read",module:"role",description:"查看角色列表和详情"},{id:"5",name:"管理角色",code:"role:write",module:"role",description:"创建和编辑角色"},{id:"6",name:"删除角色",code:"role:delete",module:"role",description:"删除角色"},{id:"7",name:"查看权限",code:"permission:read",module:"permission",description:"查看权限列表"},{id:"8",name:"管理权限",code:"permission:write",module:"permission",description:"分配和管理权限"},{id:"9",name:"删除权限",code:"permission:delete",module:"permission",description:"删除权限配置"},{id:"10",name:"查看项目",code:"project:read",module:"project",description:"查看项目信息"},{id:"11",name:"管理项目",code:"project:write",module:"project",description:"创建和编辑项目"},{id:"12",name:"删除项目",code:"project:delete",module:"project",description:"删除项目"},{id:"13",name:"查看样本",code:"sample:read",module:"sample",description:"查看样本信息"},{id:"14",name:"管理样本",code:"sample:write",module:"sample",description:"登记和管理样本"},{id:"15",name:"删除样本",code:"sample:delete",module:"sample",description:"删除样本记录"},{id:"16",name:"查看实验",code:"experiment:read",module:"experiment",description:"查看实验流程"},{id:"17",name:"管理实验",code:"experiment:write",module:"experiment",description:"执行和管理实验"},{id:"18",name:"删除实验",code:"experiment:delete",module:"experiment",description:"删除实验记录"},{id:"19",name:"查看分析",code:"analysis:read",module:"analysis",description:"查看分析结果"},{id:"20",name:"执行分析",code:"analysis:write",module:"analysis",description:"执行生信分析"},{id:"21",name:"删除分析",code:"analysis:delete",module:"analysis",description:"删除分析任务"},{id:"22",name:"查看报告",code:"report:read",module:"report",description:"查看分析报告"},{id:"23",name:"生成报告",code:"report:write",module:"report",description:"生成和编辑报告"},{id:"24",name:"删除报告",code:"report:delete",module:"report",description:"删除报告文件"},{id:"25",name:"查看档案",code:"archive:read",module:"archive",description:"查看档案信息"},{id:"26",name:"管理档案",code:"archive:write",module:"archive",description:"管理基础档案"},{id:"27",name:"删除档案",code:"archive:delete",module:"archive",description:"删除档案记录"},{id:"28",name:"系统设置",code:"system:read",module:"system",description:"查看系统设置"},{id:"29",name:"系统配置",code:"system:write",module:"system",description:"修改系统配置"},{id:"30",name:"系统维护",code:"system:delete",module:"system",description:"系统维护操作"}])})()},[]);const Ze=e=>({active:"green",inactive:"red",pending:"orange",locked:"gray"}[e]),Le=e=>({active:"正常",inactive:"禁用",pending:"待激活",locked:"锁定"}[e]),Pe=[{title:"用户信息",key:"userInfo",width:200,fixed:"left",render:(s,i)=>e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(N,{size:40,icon:e.jsx(n,{}),src:i.avatar,style:{marginRight:12}}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:500},children:[i.fullName,i.isOnline&&e.jsx(S,{status:"success",style:{marginLeft:8},title:"在线"})]}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["@",i.username]})]})]})},{title:"联系方式",key:"contact",width:180,render:(s,i)=>e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"12px"},children:[e.jsx(q,{})," ",i.email]}),e.jsxs("div",{style:{fontSize:"12px",marginTop:4},children:[e.jsx(O,{})," ",i.phone]})]})},{title:"角色",dataIndex:"roleName",key:"roleName",width:120,render:(s,i)=>e.jsx(f,{color:"1"===i.roleId?"red":"blue",icon:"1"===i.roleId?e.jsx(T,{}):e.jsx(D,{}),children:s})},{title:"部门/职位",key:"department",width:150,render:(s,i)=>e.jsxs("div",{children:[e.jsx("div",{children:i.department}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:i.position})]})},{title:"状态",dataIndex:"status",key:"status",width:80,render:s=>e.jsx(f,{color:Ze(s),children:Le(s)})},{title:"登录统计",key:"loginStats",width:120,render:(s,i)=>e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"12px"},children:["登录次数: ",i.loginCount]}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["最后登录: ",i.lastLoginTime?j(i.lastLoginTime).format("MM-DD HH:mm"):"从未登录"]})]})},{title:"入职时间",dataIndex:"hireDate",key:"hireDate",width:100,render:e=>j(e).format("YYYY-MM-DD")},{title:"操作",key:"action",width:180,fixed:"right",render:(s,i)=>e.jsxs(c,{size:"small",children:[e.jsx(Y,{title:"查看详情",children:e.jsx(x,{type:"text",icon:e.jsx(M,{}),onClick:()=>Oe(i)})}),e.jsx(Y,{title:"编辑",children:e.jsx(x,{type:"text",icon:e.jsx(F,{}),onClick:()=>qe(i)})}),e.jsx(Y,{title:"active"===i.status?"禁用":"启用",children:e.jsx(x,{type:"text",icon:"active"===i.status?e.jsx(B,{}):e.jsx($,{}),onClick:()=>Ye(i.id,i.status)})}),e.jsx(Y,{title:"重置密码",children:e.jsx(x,{type:"text",icon:e.jsx(E,{}),onClick:()=>Me(i.id)})}),!i.isSystem&&e.jsx(U,{title:"确定要删除这个用户吗？",onConfirm:()=>Fe(i.id),okText:"确定",cancelText:"取消",children:e.jsx(Y,{title:"删除",children:e.jsx(x,{type:"text",danger:!0,icon:e.jsx(R,{})})})})]})}],Ne=[{title:"角色名称",dataIndex:"name",key:"name",width:150,render:(s,i)=>e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:500},children:[i.isSystem&&e.jsx(T,{style:{color:"#faad14",marginRight:4}}),s]}),e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:i.code})]})},{title:"描述",dataIndex:"description",key:"description",ellipsis:!0},{title:"级别",dataIndex:"level",key:"level",width:80,render:s=>e.jsxs(f,{color:"blue",children:["L",s]})},{title:"用户数量",dataIndex:"userCount",key:"userCount",width:100,render:s=>e.jsx(S,{count:s,showZero:!0,color:"#52c41a"})},{title:"权限数量",key:"permissionCount",width:100,render:(s,i)=>e.jsx(S,{count:i.permissions.length,showZero:!0,color:"#1890ff"})},{title:"状态",dataIndex:"status",key:"status",width:80,render:s=>e.jsx(f,{color:Ze(s),children:Le(s)})},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:110,render:e=>j(e).format("YYYY-MM-DD")},{title:"操作",key:"action",width:150,render:(s,i)=>e.jsxs(c,{size:"small",children:[e.jsx(Y,{title:"编辑",children:e.jsx(x,{type:"text",icon:e.jsx(F,{}),onClick:()=>Be(i)})}),e.jsx(Y,{title:"权限配置",children:e.jsx(x,{type:"text",icon:e.jsx(I,{}),onClick:()=>$e(i)})}),!i.isSystem&&e.jsx(U,{title:"确定要删除这个角色吗？",onConfirm:()=>Ee(i.id),okText:"确定",cancelText:"取消",children:e.jsx(Y,{title:"删除",children:e.jsx(x,{type:"text",danger:!0,icon:e.jsx(R,{})})})})]})}],qe=e=>{je(e),fe.setFieldsValue({...e,hireDate:e.hireDate?j(e.hireDate):null}),de(!0)},Oe=e=>{we(e),pe(!0)},Ye=async(e,s)=>{try{const i="active"===s?"inactive":"active";ee(G.map(s=>s.id===e?{...s,status:i,updatedAt:(new Date).toISOString()}:s)),P.success("用户已"+("active"===i?"启用":"禁用"))}catch(i){P.error("操作失败")}},Me=async e=>{try{await new Promise(e=>setTimeout(e,500)),P.success("密码重置成功，新密码已发送到用户邮箱")}catch(s){P.error("密码重置失败")}},Fe=async e=>{try{await new Promise(e=>setTimeout(e,500)),ee(G.filter(s=>s.id!==e)),P.success("用户删除成功")}catch(s){P.error("删除用户失败")}},Be=e=>{ye(e),Ie.setFieldsValue(e),ce(!0)},$e=e=>{ye(e),he(!0)},Ee=async e=>{try{await new Promise(e=>setTimeout(e,500)),ie(se.filter(s=>s.id!==e)),P.success("角色删除成功")}catch(s){P.error("删除角色失败")}},Ue=G.filter(e=>{const s=!Se||e.fullName.toLowerCase().includes(Se.toLowerCase())||e.username.toLowerCase().includes(Se.toLowerCase())||e.email.toLowerCase().includes(Se.toLowerCase()),i=!Ce||e.status===Ce,t=!ke||e.roleId===ke;return s&&i&&t}),Re={totalUsers:G.length,activeUsers:G.filter(e=>"active"===e.status).length,onlineUsers:G.filter(e=>e.isOnline).length,totalRoles:se.length,totalPermissions:te.length},_e=te.reduce((e,s)=>{const i=e.findIndex(e=>e.key===s.module);return-1===i?e.push({title:s.module,key:s.module,children:[{title:s.name,key:s.code,description:s.description}]}):e[i].children.push({title:s.name,key:s.code,description:s.description}),e},[]);return e.jsxs("div",{children:[e.jsxs(t,{gutter:16,style:{marginBottom:16},children:[e.jsx(r,{span:6,children:e.jsx(l,{children:e.jsx(a,{title:"用户总数",value:Re.totalUsers,prefix:e.jsx(n,{})})})}),e.jsx(r,{span:6,children:e.jsx(l,{children:e.jsx(a,{title:"活跃用户",value:Re.activeUsers,valueStyle:{color:"#52c41a"}})})}),e.jsx(r,{span:6,children:e.jsx(l,{children:e.jsx(a,{title:"在线用户",value:Re.onlineUsers,valueStyle:{color:"#1890ff"}})})}),e.jsx(r,{span:6,children:e.jsx(l,{children:e.jsx(a,{title:"角色数量",value:Re.totalRoles,prefix:e.jsx(d,{})})})})]}),e.jsx(l,{children:e.jsxs(o,{activeKey:ze,onChange:De,children:[e.jsxs(H,{tab:"用户管理",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(c,{children:[e.jsx(m.Search,{placeholder:"搜索用户名、姓名或邮箱",value:Se,onChange:e=>be(e.target.value),style:{width:300}}),e.jsxs(h,{placeholder:"筛选状态",value:Ce,onChange:Te,style:{width:120},allowClear:!0,children:[e.jsx(_,{value:"active",children:"正常"}),e.jsx(_,{value:"inactive",children:"禁用"}),e.jsx(_,{value:"pending",children:"待激活"}),e.jsx(_,{value:"locked",children:"锁定"})]}),e.jsx(h,{placeholder:"筛选角色",value:ke,onChange:Ae,style:{width:150},allowClear:!0,children:se.map(s=>e.jsx(_,{value:s.id,children:s.name},s.id))}),e.jsx(x,{type:"primary",icon:e.jsx(p,{}),onClick:()=>{je(null),fe.resetFields(),de(!0)},children:"新增用户"})]})}),e.jsx(u,{columns:Pe,dataSource:Ue,rowKey:"id",loading:le,scroll:{x:1400},pagination:{total:Ue.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`}})]},"users"),e.jsxs(H,{tab:"角色管理",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(x,{type:"primary",icon:e.jsx(g,{}),onClick:()=>{ye(null),Ie.resetFields(),ce(!0)},children:"新增角色"})}),e.jsx(u,{columns:Ne,dataSource:se,rowKey:"id",loading:le,pagination:{total:se.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`}})]},"roles"),e.jsxs(H,{tab:"权限管理",children:[e.jsx(y,{message:"权限管理",description:"系统权限按模块分组管理，支持细粒度的权限控制",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(v,{defaultActiveKey:["user","project","sample"],children:Object.entries(te.reduce((e,s)=>(e[s.module]||(e[s.module]=[]),e[s.module].push(s),e),{})).map(([s,i])=>e.jsx(V,{header:e.jsxs("div",{children:[e.jsxs("strong",{children:[s.toUpperCase(),"模块"]}),e.jsx(S,{count:i.length,style:{marginLeft:8},color:"#1890ff"})]}),children:e.jsx(w,{dataSource:i,renderItem:s=>e.jsx(w.Item,{children:e.jsx(w.Item.Meta,{avatar:e.jsx(I,{style:{color:"#1890ff"}}),title:e.jsxs("div",{children:[e.jsx("strong",{children:s.name}),e.jsx(f,{style:{marginLeft:8},color:"blue",children:s.code})]}),description:s.description})})})},s))})]},"permissions"),e.jsxs(H,{tab:"操作日志",children:[e.jsx(y,{message:"操作日志",description:"记录用户权限相关的所有操作，便于审计和追踪",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(b,{children:[e.jsxs(b.Item,{color:"green",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"2024-02-15 09:30"}),' - 管理员 创建了用户 "张三"']}),e.jsx("div",{style:{color:"#666",fontSize:"12px"},children:"操作IP: 192.168.1.100"})]}),e.jsxs(b.Item,{color:"blue",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"2024-02-14 16:45"}),' - 李四 修改了角色 "项目经理" 的权限']}),e.jsx("div",{style:{color:"#666",fontSize:"12px"},children:"操作IP: 192.168.1.101"})]}),e.jsxs(b.Item,{color:"orange",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"2024-02-14 14:20"}),' - 管理员 禁用了用户 "赵六"']}),e.jsx("div",{style:{color:"#666",fontSize:"12px"},children:"操作IP: 192.168.1.100"})]}),e.jsxs(b.Item,{color:"red",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"2024-02-13 11:15"}),' - 系统 检测到用户 "王五" 异常登录']}),e.jsx("div",{style:{color:"#666",fontSize:"12px"},children:"登录IP: 203.0.113.1 (异地登录)"})]})]})]},"logs")]})}),e.jsx(C,{title:ue?"编辑用户":"新增用户",open:ne,onCancel:()=>{de(!1),fe.resetFields()},footer:null,width:800,children:e.jsxs(i,{form:fe,layout:"vertical",onFinish:async e=>{var s,i;try{ae(!0),await new Promise(e=>setTimeout(e,1e3));const t={...e,hireDate:e.hireDate?e.hireDate.format("YYYY-MM-DD"):null,roleName:(null==(s=se.find(s=>s.id===e.roleId))?void 0:s.name)||"",loginCount:0,isOnline:!1,permissions:(null==(i=se.find(s=>s.id===e.roleId))?void 0:i.permissions)||[]};if(ue){const e={...ue,...t,updatedAt:(new Date).toISOString()};ee(G.map(s=>s.id===ue.id?e:s)),P.success("用户更新成功")}else{const e={id:Date.now().toString(),...t,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};ee([...G,e]),P.success("用户创建成功")}de(!1),fe.resetFields()}catch(t){P.error("操作失败")}finally{ae(!1)}},children:[e.jsxs(t,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"username",label:"用户名",rules:[{required:!0,message:"请输入用户名"},{pattern:/^[a-zA-Z0-9_]{3,20}$/,message:"用户名只能包含字母、数字和下划线，长度3-20位"}],children:e.jsx(m,{placeholder:"请输入用户名"})})}),e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"fullName",label:"姓名",rules:[{required:!0,message:"请输入姓名"}],children:e.jsx(m,{placeholder:"请输入姓名"})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"email",label:"邮箱",rules:[{required:!0,message:"请输入邮箱"},{type:"email",message:"请输入有效的邮箱地址"}],children:e.jsx(m,{placeholder:"请输入邮箱"})})}),e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"phone",label:"手机号",rules:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入有效的手机号"}],children:e.jsx(m,{placeholder:"请输入手机号"})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(r,{span:8,children:e.jsx(i.Item,{name:"roleId",label:"角色",rules:[{required:!0,message:"请选择角色"}],children:e.jsx(h,{placeholder:"请选择角色",children:se.map(s=>e.jsxs(_,{value:s.id,children:[s.isSystem&&e.jsx(T,{style:{marginRight:4}}),s.name]},s.id))})})}),e.jsx(r,{span:8,children:e.jsx(i.Item,{name:"department",label:"部门",rules:[{required:!0,message:"请输入部门"}],children:e.jsx(m,{placeholder:"请输入部门"})})}),e.jsx(r,{span:8,children:e.jsx(i.Item,{name:"position",label:"职位",rules:[{required:!0,message:"请输入职位"}],children:e.jsx(m,{placeholder:"请输入职位"})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(r,{span:8,children:e.jsx(i.Item,{name:"employeeId",label:"工号",rules:[{required:!0,message:"请输入工号"}],children:e.jsx(m,{placeholder:"请输入工号"})})}),e.jsx(r,{span:8,children:e.jsx(i.Item,{name:"hireDate",label:"入职日期",rules:[{required:!0,message:"请选择入职日期"}],children:e.jsx(k,{style:{width:"100%"},placeholder:"请选择入职日期"})})}),e.jsx(r,{span:8,children:e.jsx(i.Item,{name:"status",label:"状态",rules:[{required:!0,message:"请选择状态"}],children:e.jsxs(h,{placeholder:"请选择状态",children:[e.jsx(_,{value:"active",children:"正常"}),e.jsx(_,{value:"inactive",children:"禁用"}),e.jsx(_,{value:"pending",children:"待激活"})]})})})]}),!ue&&e.jsxs(t,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码"},{min:6,message:"密码至少6位"}],children:e.jsx(m.Password,{placeholder:"请输入密码"})})}),e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"confirmPassword",label:"确认密码",dependencies:["password"],rules:[{required:!0,message:"请确认密码"},({getFieldValue:e})=>({validator:(s,i)=>i&&e("password")!==i?Promise.reject(new Error("两次输入的密码不一致")):Promise.resolve()})],children:e.jsx(m.Password,{placeholder:"请确认密码"})})})]}),e.jsx(i.Item,{style:{textAlign:"right",marginBottom:0},children:e.jsxs(c,{children:[e.jsx(x,{onClick:()=>de(!1),children:"取消"}),e.jsx(x,{type:"primary",htmlType:"submit",loading:le,children:ue?"更新":"创建"})]})})]})}),e.jsx(C,{title:ge?"编辑角色":"新增角色",open:oe,onCancel:()=>{ce(!1),Ie.resetFields()},footer:null,width:600,children:e.jsxs(i,{form:Ie,layout:"vertical",onFinish:async e=>{try{if(ae(!0),await new Promise(e=>setTimeout(e,1e3)),ge){const s={...ge,...e,updatedAt:(new Date).toISOString()};ie(se.map(e=>e.id===ge.id?s:e)),P.success("角色更新成功")}else{const s={id:Date.now().toString(),...e,userCount:0,permissions:[],isSystem:!1,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};ie([...se,s]),P.success("角色创建成功")}ce(!1),Ie.resetFields()}catch(s){P.error("操作失败")}finally{ae(!1)}},children:[e.jsxs(t,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"name",label:"角色名称",rules:[{required:!0,message:"请输入角色名称"}],children:e.jsx(m,{placeholder:"请输入角色名称"})})}),e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"code",label:"角色代码",rules:[{required:!0,message:"请输入角色代码"},{pattern:/^[a-z_]+$/,message:"角色代码只能包含小写字母和下划线"}],children:e.jsx(m,{placeholder:"请输入角色代码"})})})]}),e.jsx(i.Item,{name:"description",label:"角色描述",rules:[{required:!0,message:"请输入角色描述"}],children:e.jsx(K,{rows:3,placeholder:"请输入角色描述"})}),e.jsxs(t,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"level",label:"角色级别",rules:[{required:!0,message:"请选择角色级别"}],children:e.jsxs(h,{placeholder:"请选择角色级别",children:[e.jsx(_,{value:1,children:"L1 - 超级管理员"}),e.jsx(_,{value:2,children:"L2 - 管理员"}),e.jsx(_,{value:3,children:"L3 - 高级用户"}),e.jsx(_,{value:4,children:"L4 - 普通用户"}),e.jsx(_,{value:5,children:"L5 - 访客"})]})})}),e.jsx(r,{span:12,children:e.jsx(i.Item,{name:"status",label:"状态",rules:[{required:!0,message:"请选择状态"}],children:e.jsxs(h,{placeholder:"请选择状态",children:[e.jsx(_,{value:"active",children:"正常"}),e.jsx(_,{value:"inactive",children:"禁用"})]})})})]}),e.jsx(i.Item,{style:{textAlign:"right",marginBottom:0},children:e.jsxs(c,{children:[e.jsx(x,{onClick:()=>ce(!1),children:"取消"}),e.jsx(x,{type:"primary",htmlType:"submit",loading:le,children:ge?"更新":"创建"})]})})]})}),e.jsx(C,{title:`配置角色权限: ${null==ge?void 0:ge.name}`,open:me,onCancel:()=>he(!1),footer:[e.jsx(x,{onClick:()=>he(!1),children:"取消"},"cancel"),e.jsx(x,{type:"primary",children:"保存权限"},"save")],width:800,children:ge&&e.jsxs("div",{children:[e.jsx(y,{message:"权限配置",description:`为角色 "${ge.name}" 配置系统权限，请谨慎操作`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(A,{checkable:!0,defaultExpandAll:!0,defaultCheckedKeys:ge.permissions,treeData:_e,titleRender:s=>e.jsxs("div",{children:[e.jsx("span",{children:s.title}),s.description&&e.jsx("div",{style:{fontSize:"12px",color:"#666"},children:s.description})]})})]})}),e.jsx(C,{title:"用户详情",open:xe,onCancel:()=>pe(!1),footer:[e.jsx(x,{onClick:()=>pe(!1),children:"关闭"},"close")],width:800,children:ve&&e.jsxs("div",{children:[e.jsxs(z,{bordered:!0,column:2,children:[e.jsx(z.Item,{label:"用户名",children:ve.username}),e.jsx(z.Item,{label:"姓名",children:ve.fullName}),e.jsx(z.Item,{label:"邮箱",children:ve.email}),e.jsx(z.Item,{label:"手机号",children:ve.phone}),e.jsx(z.Item,{label:"角色",children:e.jsx(f,{color:"1"===ve.roleId?"red":"blue",icon:"1"===ve.roleId?e.jsx(T,{}):e.jsx(D,{}),children:ve.roleName})}),e.jsx(z.Item,{label:"状态",children:e.jsx(f,{color:Ze(ve.status),children:Le(ve.status)})}),e.jsx(z.Item,{label:"部门",children:ve.department}),e.jsx(z.Item,{label:"职位",children:ve.position}),e.jsx(z.Item,{label:"工号",children:ve.employeeId}),e.jsx(z.Item,{label:"入职日期",children:ve.hireDate}),e.jsx(z.Item,{label:"登录次数",children:ve.loginCount}),e.jsx(z.Item,{label:"在线状态",children:ve.isOnline?e.jsx(S,{status:"success",text:"在线"}):e.jsx(S,{status:"default",text:"离线"})})]}),e.jsx(Z,{}),e.jsx(Q,{level:5,children:"最后登录时间"}),e.jsx(J,{children:ve.lastLoginTime?j(ve.lastLoginTime).format("YYYY-MM-DD HH:mm:ss"):"从未登录"}),e.jsx(Z,{}),e.jsx(Q,{level:5,children:"用户权限"}),e.jsx(c,{wrap:!0,children:ve.permissions.map((s,i)=>e.jsx(f,{color:"blue",children:s},i))}),e.jsx(Z,{}),e.jsx(Q,{level:5,children:"偏好设置"}),e.jsxs(z,{size:"small",column:1,children:[e.jsx(z.Item,{label:"语言",children:(null==(L=ve.preferences)?void 0:L.language)||"zh-CN"}),e.jsx(z.Item,{label:"主题",children:(null==(W=ve.preferences)?void 0:W.theme)||"light"}),e.jsx(z.Item,{label:"时区",children:(null==(X=ve.preferences)?void 0:X.timezone)||"Asia/Shanghai"})]})]})})]})};export{G as default};
