import{j as e}from"./index-DyvGJ5NW.js";import{a as s}from"./react-vendor-DKSb2WWV.js";import{a0 as i,O as a,a as r,c as t,e as n,a2 as l,a7 as d,a3 as h,a4 as c,S as o,B as m,n as x,a5 as p,s as j,aR as u,am as D,a6 as f,W as y,ag as w,ai as T,aj as Y}from"./antd-vendor-CqkZOb36.js";const{RangePicker:g}=c,{Option:H}=h,{TextArea:M}=l,S=()=>{const[M,S]=s.useState([]),[I,C]=s.useState(!1),[b,k]=s.useState([]),[v,q]=s.useState(!1),[V,N]=s.useState(null),[R,A]=s.useState(""),[F,B]=s.useState(""),[_,P]=s.useState(""),[z,L]=s.useState(null),[O]=i.useForm(),Q=async()=>{C(!0);try{await new Promise(e=>setTimeout(e,1e3));S([{id:"1",chipName:"NovaSeq-S4-001",brand:"Illumina",chipDD:"DD20240115001",expiryDate:"2024-12-31",startTime:"2024-01-15 09:00:00",endTime:"2024-01-15 18:30:00",initialValidHoles:8e9,endValidHoles:64e8,sampleCount:24,experimentDepartment:"基因组学部",experimentStaff:"张三",qualityReport:"QC_Report_20240115.pdf",reportTime:"2024-01-15 19:00:00",washTime:"2024-01-15 20:00:00",washStaff:"李四",createdAt:"2024-01-15 19:30:00",updatedAt:"2024-01-15 19:30:00"},{id:"2",chipName:"MiSeq-v3-002",brand:"Illumina",chipDD:"DD20240114002",expiryDate:"2024-11-30",startTime:"2024-01-14 14:00:00",endTime:"2024-01-14 22:00:00",initialValidHoles:25e6,endValidHoles:2e7,sampleCount:12,experimentDepartment:"外显子组学部",experimentStaff:"王五",qualityReport:"QC_Report_20240114.pdf",reportTime:"2024-01-14 22:30:00",washTime:"2024-01-14 23:00:00",washStaff:"赵六",createdAt:"2024-01-14 23:30:00",updatedAt:"2024-01-14 23:30:00"},{id:"3",chipName:"HiSeq-2500-003",brand:"Illumina",chipDD:"DD20240113003",expiryDate:"2024-10-31",startTime:"2024-01-13 08:30:00",endTime:"2024-01-13 20:00:00",initialValidHoles:4e9,endValidHoles:32e8,sampleCount:8,experimentDepartment:"转录组学部",experimentStaff:"孙七",qualityReport:"QC_Report_20240113.pdf",reportTime:"2024-01-13 20:30:00",washTime:"2024-01-13 21:00:00",washStaff:"周八",createdAt:"2024-01-13 21:30:00",updatedAt:"2024-01-13 21:30:00"},{id:"4",chipName:"NextSeq-550-004",brand:"Illumina",chipDD:"DD20240112004",expiryDate:"2024-09-30",startTime:"2024-01-12 13:00:00",endTime:"2024-01-12 19:30:00",initialValidHoles:13e8,endValidHoles:104e7,sampleCount:16,experimentDepartment:"靶向测序部",experimentStaff:"吴九",qualityReport:"QC_Report_20240112.pdf",reportTime:"2024-01-12 20:00:00",washTime:"2024-01-12 20:30:00",washStaff:"郑十",createdAt:"2024-01-12 21:00:00",updatedAt:"2024-01-12 21:00:00"},{id:"5",chipName:"NovaSeq-S2-005",brand:"Illumina",chipDD:"DD20240111005",expiryDate:"2024-08-31",startTime:"2024-01-11 10:00:00",endTime:"2024-01-11 16:30:00",initialValidHoles:33e8,endValidHoles:264e7,sampleCount:6,experimentDepartment:"宏基因组学部",experimentStaff:"钱一",qualityReport:"QC_Report_20240111.pdf",reportTime:"2024-01-11 17:00:00",washTime:"2024-01-11 17:30:00",washStaff:"陈二",createdAt:"2024-01-11 18:00:00",updatedAt:"2024-01-11 18:00:00"}])}catch(e){j.error("加载数据失败")}finally{C(!1)}};s.useEffect(()=>{Q()},[]);const $=[{title:"芯片名称",dataIndex:"chipName",key:"chipName",width:150,fixed:"left"},{title:"品牌",dataIndex:"brand",key:"brand",width:100},{title:"芯片DD",dataIndex:"chipDD",key:"chipDD",width:140},{title:"有效期",dataIndex:"expiryDate",key:"expiryDate",width:120,render:s=>{const i=a(s).isBefore(a());return e.jsx("span",{style:{color:i?"#ff4d4f":"#52c41a"},children:a(s).format("YYYY-MM-DD")})}},{title:"上机开始时间",dataIndex:"startTime",key:"startTime",width:160,render:e=>a(e).format("YYYY-MM-DD HH:mm:ss")},{title:"上机结束时间",dataIndex:"endTime",key:"endTime",width:160,render:e=>a(e).format("YYYY-MM-DD HH:mm:ss")},{title:"初始有效孔数",dataIndex:"initialValidHoles",key:"initialValidHoles",width:130,render:s=>e.jsxs("span",{style:{fontWeight:"bold",color:"#1890ff"},children:[(s/1e6).toFixed(0),"M"]})},{title:"结束有效孔数",dataIndex:"endValidHoles",key:"endValidHoles",width:130,render:s=>e.jsxs("span",{style:{fontWeight:"bold",color:"#52c41a"},children:[(s/1e6).toFixed(0),"M"]})},{title:"样本数量",dataIndex:"sampleCount",key:"sampleCount",width:100,render:s=>e.jsx("span",{style:{fontWeight:"bold"},children:s})},{title:"实验科室",dataIndex:"experimentDepartment",key:"experimentDepartment",width:120},{title:"实验人员",dataIndex:"experimentStaff",key:"experimentStaff",width:100},{title:"质控报告",dataIndex:"qualityReport",key:"qualityReport",width:150,render:s=>e.jsx(m,{type:"link",size:"small",onClick:()=>W(s),children:s})},{title:"报告时间",dataIndex:"reportTime",key:"reportTime",width:160,render:e=>a(e).format("YYYY-MM-DD HH:mm:ss")},{title:"消洗时间",dataIndex:"washTime",key:"washTime",width:160,render:e=>a(e).format("YYYY-MM-DD HH:mm:ss")},{title:"清洗人",dataIndex:"washStaff",key:"washStaff",width:100},{title:"操作",key:"action",width:180,fixed:"right",render:(s,i)=>e.jsxs(o,{size:"small",children:[e.jsx(m,{type:"link",size:"small",icon:e.jsx(T,{}),onClick:()=>K(i),children:"详情"}),e.jsx(m,{type:"link",size:"small",icon:e.jsx(Y,{}),onClick:()=>E(i),children:"编辑"}),e.jsx(D,{title:"确定删除这条记录吗？",onConfirm:()=>J(i.id),okText:"确定",cancelText:"取消",children:e.jsx(m,{type:"link",size:"small",danger:!0,icon:e.jsx(f,{}),children:"删除"})})]})}],W=e=>{j.info(`下载报告: ${e}`)},K=s=>{w.info({title:"芯片使用记录详情",width:800,content:e.jsx("div",{style:{marginTop:"16px"},children:e.jsxs(t,{gutter:[16,8],children:[e.jsx(n,{span:8,children:e.jsx("strong",{children:"芯片名称："})}),e.jsx(n,{span:16,children:s.chipName}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"品牌："})}),e.jsx(n,{span:16,children:s.brand}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"芯片DD："})}),e.jsx(n,{span:16,children:s.chipDD}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"有效期："})}),e.jsx(n,{span:16,children:a(s.expiryDate).format("YYYY-MM-DD")}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"上机开始时间："})}),e.jsx(n,{span:16,children:a(s.startTime).format("YYYY-MM-DD HH:mm:ss")}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"上机结束时间："})}),e.jsx(n,{span:16,children:a(s.endTime).format("YYYY-MM-DD HH:mm:ss")}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"初始有效孔数："})}),e.jsxs(n,{span:16,children:[(s.initialValidHoles/1e6).toFixed(0),"M"]}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"结束有效孔数："})}),e.jsxs(n,{span:16,children:[(s.endValidHoles/1e6).toFixed(0),"M"]}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"样本数量："})}),e.jsx(n,{span:16,children:s.sampleCount}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"实验科室："})}),e.jsx(n,{span:16,children:s.experimentDepartment}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"实验人员："})}),e.jsx(n,{span:16,children:s.experimentStaff}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"质控报告："})}),e.jsx(n,{span:16,children:s.qualityReport}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"报告时间："})}),e.jsx(n,{span:16,children:a(s.reportTime).format("YYYY-MM-DD HH:mm:ss")}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"消洗时间："})}),e.jsx(n,{span:16,children:a(s.washTime).format("YYYY-MM-DD HH:mm:ss")}),e.jsx(n,{span:8,children:e.jsx("strong",{children:"清洗人："})}),e.jsx(n,{span:16,children:s.washStaff})]})})})},E=e=>{N(e),O.setFieldsValue({...e,expiryDate:a(e.expiryDate),startTime:a(e.startTime),endTime:a(e.endTime),reportTime:a(e.reportTime),washTime:a(e.washTime)}),q(!0)},J=async e=>{try{await new Promise(e=>setTimeout(e,500)),S(M.filter(s=>s.id!==e)),j.success("删除成功")}catch(s){j.error("删除失败")}},G=M.filter(e=>{const s=!R||e.chipName.toLowerCase().includes(R.toLowerCase())||e.chipDD.toLowerCase().includes(R.toLowerCase())||e.experimentStaff.toLowerCase().includes(R.toLowerCase()),i=!F||e.brand===F,r=!_||e.experimentDepartment===_,t=!z||!z[0]||!z[1]||a(e.startTime).isAfter(z[0].subtract(1,"day"))&&a(e.startTime).isBefore(z[1].add(1,"day"));return s&&i&&r&&t});return e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(r,{title:"芯片使用记录",children:[e.jsxs(t,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(n,{span:6,children:e.jsx(l,{placeholder:"搜索芯片名称、芯片DD或实验人员",prefix:e.jsx(d,{}),value:R,onChange:e=>A(e.target.value),allowClear:!0})}),e.jsx(n,{span:4,children:e.jsxs(h,{placeholder:"品牌筛选",value:F,onChange:B,allowClear:!0,style:{width:"100%"},children:[e.jsx(H,{value:"Illumina",children:"Illumina"}),e.jsx(H,{value:"Thermo Fisher",children:"Thermo Fisher"}),e.jsx(H,{value:"PacBio",children:"PacBio"}),e.jsx(H,{value:"Oxford Nanopore",children:"Oxford Nanopore"})]})}),e.jsx(n,{span:4,children:e.jsxs(h,{placeholder:"实验科室",value:_,onChange:P,allowClear:!0,style:{width:"100%"},children:[e.jsx(H,{value:"基因组学部",children:"基因组学部"}),e.jsx(H,{value:"外显子组学部",children:"外显子组学部"}),e.jsx(H,{value:"转录组学部",children:"转录组学部"}),e.jsx(H,{value:"靶向测序部",children:"靶向测序部"}),e.jsx(H,{value:"宏基因组学部",children:"宏基因组学部"})]})}),e.jsx(n,{span:6,children:e.jsx(g,{value:z,onChange:L,style:{width:"100%"},placeholder:["开始时间","结束时间"],showTime:!0})}),e.jsx(n,{span:4,children:e.jsx(o,{children:e.jsx(m,{icon:e.jsx(x,{}),onClick:Q,children:"刷新"})})})]}),e.jsx(t,{style:{marginBottom:"16px"},children:e.jsx(n,{span:24,children:e.jsxs(o,{children:[e.jsx(m,{type:"primary",icon:e.jsx(p,{}),onClick:()=>{N(null),O.resetFields(),q(!0)},children:"新增记录"}),e.jsx(m,{icon:e.jsx(u,{}),onClick:()=>j.info("导出功能开发中"),children:"导出数据"}),b.length>0&&e.jsx(D,{title:`确定删除选中的 ${b.length} 条记录吗？`,onConfirm:async()=>{try{await new Promise(e=>setTimeout(e,500)),S(M.filter(e=>!b.includes(e.id))),k([]),j.success("批量删除成功")}catch(e){j.error("批量删除失败")}},okText:"确定",cancelText:"取消",children:e.jsxs(m,{danger:!0,icon:e.jsx(f,{}),children:["批量删除 (",b.length,")"]})})]})})}),e.jsx(y,{columns:$,dataSource:G,rowKey:"id",loading:I,scroll:{x:2e3},rowSelection:{selectedRowKeys:b,onChange:k},pagination:{total:G.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,s)=>`第 ${s[0]}-${s[1]} 条/共 ${e} 条`}})]}),e.jsx(w,{title:V?"编辑芯片使用记录":"新增芯片使用记录",open:v,onCancel:()=>q(!1),footer:null,width:900,children:e.jsxs(i,{form:O,layout:"vertical",onFinish:async e=>{try{C(!0),await new Promise(e=>setTimeout(e,1e3));const s={...e,expiryDate:e.expiryDate.format("YYYY-MM-DD"),startTime:e.startTime.format("YYYY-MM-DD HH:mm:ss"),endTime:e.endTime.format("YYYY-MM-DD HH:mm:ss"),reportTime:e.reportTime.format("YYYY-MM-DD HH:mm:ss"),washTime:e.washTime.format("YYYY-MM-DD HH:mm:ss")};if(V)S(M.map(e=>e.id===V.id?{...e,...s,updatedAt:a().format("YYYY-MM-DD HH:mm:ss")}:e)),j.success("更新成功");else{const e={id:Date.now().toString(),...s,createdAt:a().format("YYYY-MM-DD HH:mm:ss"),updatedAt:a().format("YYYY-MM-DD HH:mm:ss")};S([e,...M]),j.success("新增成功")}q(!1),O.resetFields()}catch(s){j.error("操作失败")}finally{C(!1)}},children:[e.jsxs(t,{gutter:16,children:[e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"chipName",label:"芯片名称",rules:[{required:!0,message:"请输入芯片名称"}],children:e.jsx(l,{placeholder:"请输入芯片名称"})})}),e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"brand",label:"品牌",rules:[{required:!0,message:"请选择品牌"}],children:e.jsxs(h,{placeholder:"请选择品牌",children:[e.jsx(H,{value:"Illumina",children:"Illumina"}),e.jsx(H,{value:"Thermo Fisher",children:"Thermo Fisher"}),e.jsx(H,{value:"PacBio",children:"PacBio"}),e.jsx(H,{value:"Oxford Nanopore",children:"Oxford Nanopore"})]})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"chipDD",label:"芯片DD",rules:[{required:!0,message:"请输入芯片DD"}],children:e.jsx(l,{placeholder:"请输入芯片DD"})})}),e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"expiryDate",label:"有效期",rules:[{required:!0,message:"请选择有效期"}],children:e.jsx(c,{style:{width:"100%"},placeholder:"请选择有效期"})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"startTime",label:"上机开始时间",rules:[{required:!0,message:"请选择上机开始时间"}],children:e.jsx(c,{showTime:!0,style:{width:"100%"},placeholder:"请选择上机开始时间"})})}),e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"endTime",label:"上机结束时间",rules:[{required:!0,message:"请选择上机结束时间"}],children:e.jsx(c,{showTime:!0,style:{width:"100%"},placeholder:"请选择上机结束时间"})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"initialValidHoles",label:"初始有效孔数",rules:[{required:!0,message:"请输入初始有效孔数"}],children:e.jsx(l,{type:"number",placeholder:"请输入初始有效孔数"})})}),e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"endValidHoles",label:"结束有效孔数",rules:[{required:!0,message:"请输入结束有效孔数"}],children:e.jsx(l,{type:"number",placeholder:"请输入结束有效孔数"})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"sampleCount",label:"样本数量",rules:[{required:!0,message:"请输入样本数量"}],children:e.jsx(l,{type:"number",placeholder:"请输入样本数量"})})}),e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"experimentDepartment",label:"实验科室",rules:[{required:!0,message:"请选择实验科室"}],children:e.jsxs(h,{placeholder:"请选择实验科室",children:[e.jsx(H,{value:"基因组学部",children:"基因组学部"}),e.jsx(H,{value:"外显子组学部",children:"外显子组学部"}),e.jsx(H,{value:"转录组学部",children:"转录组学部"}),e.jsx(H,{value:"靶向测序部",children:"靶向测序部"}),e.jsx(H,{value:"宏基因组学部",children:"宏基因组学部"})]})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"experimentStaff",label:"实验人员",rules:[{required:!0,message:"请输入实验人员"}],children:e.jsx(l,{placeholder:"请输入实验人员"})})}),e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"qualityReport",label:"质控报告",rules:[{required:!0,message:"请输入质控报告文件名"}],children:e.jsx(l,{placeholder:"请输入质控报告文件名"})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"reportTime",label:"报告时间",rules:[{required:!0,message:"请选择报告时间"}],children:e.jsx(c,{showTime:!0,style:{width:"100%"},placeholder:"请选择报告时间"})})}),e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"washTime",label:"消洗时间",rules:[{required:!0,message:"请选择消洗时间"}],children:e.jsx(c,{showTime:!0,style:{width:"100%"},placeholder:"请选择消洗时间"})})})]}),e.jsx(t,{gutter:16,children:e.jsx(n,{span:12,children:e.jsx(i.Item,{name:"washStaff",label:"清洗人",rules:[{required:!0,message:"请输入清洗人"}],children:e.jsx(l,{placeholder:"请输入清洗人"})})})}),e.jsx(i.Item,{style:{textAlign:"right",marginBottom:0},children:e.jsxs(o,{children:[e.jsx(m,{onClick:()=>q(!1),children:"取消"}),e.jsx(m,{type:"primary",htmlType:"submit",loading:I,children:V?"更新":"新增"})]})})]})})]})};export{S as default};
