import{j as t}from"./index-DyvGJ5NW.js";import{a as e}from"./react-vendor-DKSb2WWV.js";function n(t){if(!t)return"";const e=t.v??t.m;return null==e?"":e}const r=({columns:r,data:o,onChange:l})=>{const a=e.useRef(null),c=e.useMemo(()=>`luckysheet-${Math.random().toString(36).slice(2)}`,[]),s=e.useRef(!1);return e.useEffect(()=>{var t,e;if(!a.current)return;if(s.current)return;try{null==(e=null==(t=window.luckysheet)?void 0:t.destroy)||e.call(t)}catch{}const u=function(t,e){if(!e)return[[]];if(Array.isArray(e)&&(0===e.length||Array.isArray(e[0])))return e;if(Array.isArray(e)&&"object"==typeof e[0]){const n=t.map(t=>t.key);return e.map(t=>n.map(e=>(null==t?void 0:t[e])??""))}return[[]]}(r,o),i=[];for(let n=0;n<u.length;n++){const t=u[n]||[];for(let e=0;e<Math.max(r.length,t.length);e++){const r=t[e];null!=r&&""!==r&&i.push({r:n,c:e,v:{v:r}})}}return(async()=>{await new Promise(t=>{if(window.jQuery||window.$)return t();const e=document.createElement("script");e.src="https://unpkg.com/jquery@3.6.0/dist/jquery.min.js",e.onload=()=>t(),e.onerror=()=>t(),document.body.appendChild(e)});const t="https://unpkg.com/luckysheet@2.1.13/dist/plugins/js/plugin.js";await new Promise(e=>{if([...document.querySelectorAll("script")].some(e=>e.src===t))return e();const n=document.createElement("script");n.src=t,n.onload=()=>e(),n.onerror=()=>e(),document.body.appendChild(n)});const e="https://unpkg.com/luckysheet@2.1.13/dist/luckysheet.umd.js";return await new Promise((t,n)=>{if([...document.querySelectorAll("script")].some(t=>t.src===e))return t();const r=document.createElement("script");r.src=e,r.onload=()=>t(),r.onerror=()=>n(new Error("加载 luckysheet 失败")),document.body.appendChild(r)}),window.luckysheet})().then(t=>{null==t||t.create({container:c,title:"批量录入",lang:"zh",allowEdit:!0,editMode:!1,showinfobar:!1,showtoolbar:!0,showsheetbar:!0,showstatisticBar:!0,sheetFormulaBar:!0,allowCopy:!0,enableAddRow:!0,enableAddBackTop:!0,showConfigWindowResize:!0,column:Math.max(r.length,26),row:Math.max(u.length+10,50),data:[{name:"Sheet1",order:0,status:1,index:0,row:Math.max(u.length+10,50),column:Math.max(r.length,26),celldata:i,config:{}}],hook:{updated:t=>{try{const e=((null==t?void 0:t.curdata)||[]).map(t=>(t||[]).map(t=>n(t)));null==l||l(e)}catch(e){const t=function(){var t;try{const e=window.luckysheet,r=null==(t=null==e?void 0:e.getAllSheets)?void 0:t.call(e);return r&&0!==r.length?(r[0].data||[]).map(t=>(t||[]).map(t=>n(t))):[]}catch(e){return[]}}();null==l||l(t)}}}}),s.current=!0}).catch(()=>{}),()=>{var t,e;try{null==(e=null==(t=window.luckysheet)?void 0:t.destroy)||e.call(t)}catch{}}},[c]),t.jsx("div",{id:c,ref:a,style:{height:"100%",width:"100%",minHeight:480}})};export{r as L};
