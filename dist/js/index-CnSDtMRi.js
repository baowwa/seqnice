import{j as e}from"./index-BD7k3pCu.js";import{r as t}from"./react-vendor-BSBC8BLg.js";import{$ as s,c as l,e as i,a as r,Q as a,I as n,a9 as d,am as o,S as c,a3 as h,a4 as x,B as p,a1 as u,V as j,O as m,ac as v,a7 as y,ai as g,aW as w,aX as I,Z as f,aY as b,a5 as S,a6 as C,l as D,ao as _,X as N,m as T,T as k,W as A,b as F,s as M,ag as P,ah as z,ak as q,al as Y,aI as Z,aa as H}from"./antd-vendor-DCQn9U8Y.js";const{Option:R}=x,{TextArea:B}=h,{TabPane:$}=o,{Step:L}=y,{Panel:O}=Z,{Text:E,Title:Q,Paragraph:U}=k,{Dragger:W}=H,V=()=>{const[k,Z]=t.useState([]),[H,L]=t.useState([]),[O,E]=t.useState([]),[U,W]=t.useState(!1),[V,X]=t.useState(!1),[J,K]=t.useState(!1),[G,ee]=t.useState(!1),[te,se]=t.useState(!1),[le,ie]=t.useState(null),[re,ae]=t.useState(null),[ne]=s.useForm(),[de]=s.useForm(),[oe,ce]=t.useState(""),[he,xe]=t.useState(""),[pe,ue]=t.useState(""),[je,me]=t.useState("reports");t.useEffect(()=>{(async()=>{W(!0);try{await new Promise(e=>setTimeout(e,500)),Z([{id:"1",title:"肠道菌群16S rRNA多样性分析报告",description:"基于16S rRNA基因的肠道菌群组成和多样性分析结果报告",type:"analysis_report",status:"published",priority:"high",projectId:"1",projectName:"肠道菌群多样性研究",analysisTaskId:"1",analysisTaskName:"肠道菌群16S rRNA多样性分析",version:"1.2",templateId:"template_16s",templateName:"16S rRNA分析报告模板",authorId:"3",authorName:"王五",reviewerId:"2",reviewerName:"李四",approvalStatus:"approved",reviewComments:"报告内容详实，数据分析准确，建议发布",reviewDate:"2024-01-25T14:30:00Z",publishDate:"2024-01-26T09:00:00Z",downloadCount:25,viewCount:156,fileSize:2.5,fileFormat:"pdf",filePath:"/reports/gut_microbiome_16s_analysis_v1.2.pdf",tags:["16S rRNA","肠道菌群","多样性分析","微生物组"],isPublic:!0,expiryDate:"2025-01-26",language:"zh-CN",customFields:{sampleCount:20,sequencingPlatform:"Illumina NovaSeq 6000",analysisMethod:"QIIME2 + DADA2",keyFindings:"发现显著的菌群多样性差异"},createdAt:"2024-01-24T10:00:00Z",updatedAt:"2024-01-26T09:00:00Z"},{id:"2",title:"土壤微生物宏基因组功能分析报告",description:"土壤样本宏基因组shotgun测序的功能基因分析报告",type:"analysis_report",status:"under_review",priority:"medium",projectId:"2",projectName:"土壤微生物功能研究",analysisTaskId:"2",analysisTaskName:"土壤微生物宏基因组功能分析",version:"1.0",templateId:"template_metagenome",templateName:"宏基因组分析报告模板",authorId:"3",authorName:"王五",reviewerId:"2",reviewerName:"李四",approvalStatus:"pending",reviewComments:"",reviewDate:null,publishDate:null,downloadCount:0,viewCount:8,fileSize:3.2,fileFormat:"pdf",filePath:"/reports/soil_metagenome_functional_analysis_v1.0.pdf",tags:["宏基因组","土壤微生物","功能分析","shotgun测序"],isPublic:!1,expiryDate:"2025-02-15",language:"zh-CN",customFields:{sampleCount:12,sequencingPlatform:"Illumina HiSeq X Ten",analysisMethod:"MetaPhlAn3 + HUMAnN3",keyFindings:"检测到丰富的碳氮循环相关基因"},createdAt:"2024-02-10T11:00:00Z",updatedAt:"2024-02-12T16:30:00Z"},{id:"3",title:"海洋微生物群落结构分析报告",description:"海水样本的16S+18S双重测序群落结构分析报告",type:"analysis_report",status:"draft",priority:"high",projectId:"3",projectName:"海洋微生物多样性分析",analysisTaskId:"3",analysisTaskName:"海洋微生物群落结构分析",version:"0.8",templateId:"template_dual",templateName:"双重测序分析报告模板",authorId:"4",authorName:"赵六",reviewerId:null,reviewerName:null,approvalStatus:"not_submitted",reviewComments:"",reviewDate:null,publishDate:null,downloadCount:0,viewCount:3,fileSize:1.8,fileFormat:"docx",filePath:"/reports/marine_microbial_community_analysis_v0.8.docx",tags:["双重测序","海洋微生物","群落结构","16S+18S"],isPublic:!1,expiryDate:"2025-03-01",language:"zh-CN",customFields:{sampleCount:30,sequencingPlatform:"Illumina MiSeq",analysisMethod:"QIIME2 + SILVA + PR2",keyFindings:"发现独特的海洋微生物群落组成"},createdAt:"2024-01-28T09:30:00Z",updatedAt:"2024-02-05T14:15:00Z"}])}catch(e){M.error("获取报告列表失败")}finally{W(!1)}})(),(async()=>{L([{id:"1",code:"PRJ001",name:"肠道菌群多样性研究",description:"研究不同饮食习惯对肠道菌群多样性的影响",status:"completed",priority:"high",type:"research",clientId:"1",clientName:"北京大学医学院",managerId:"1",managerName:"张三",startDate:"2024-01-10",expectedEndDate:"2024-02-10",actualEndDate:"2024-01-30",budget:5e4,actualCost:45e3,progress:100,sampleCount:20,completedSamples:20,notes:"项目顺利完成，结果符合预期",createdAt:"2024-01-10T09:00:00Z",updatedAt:"2024-01-30T17:00:00Z"}]),E([{id:"1",name:"肠道菌群16S rRNA多样性分析",description:"基于16S rRNA基因的肠道菌群组成和多样性分析",type:"16s_analysis",status:"completed",priority:"high",batchId:"1",batchName:"肠道菌群测序批次-202401",sampleCount:20,analysisType:"diversity",pipeline:"QIIME2",parameters:{},inputFiles:[],outputFiles:[],progress:100,startTime:"2024-01-20T09:00:00Z",endTime:"2024-01-22T15:30:00Z",estimatedDuration:2880,actualDuration:2430,assigneeId:"3",assigneeName:"王五",notes:"分析完成，结果质量良好",createdAt:"2024-01-20T09:00:00Z",updatedAt:"2024-01-22T15:30:00Z"}])})()},[]);const ve=e=>({draft:"orange",under_review:"blue",approved:"green",published:"cyan",rejected:"red",archived:"gray"}[e]),ye=e=>({draft:"草稿",under_review:"审核中",approved:"已批准",published:"已发布",rejected:"已拒绝",archived:"已归档"}[e]),ge=e=>({not_submitted:"default",pending:"orange",approved:"green",rejected:"red"}[e]),we=e=>({not_submitted:"未提交",pending:"待审核",approved:"已批准",rejected:"已拒绝"}[e]),Ie=e=>({high:"red",medium:"orange",low:"green"}[e]),fe=e=>({high:"高",medium:"中",low:"低"}[e]),be=e=>({analysis_report:"分析报告",summary_report:"总结报告",quality_report:"质量报告",progress_report:"进度报告",final_report:"最终报告"}[e]||e),Se=[{title:"报告标题",dataIndex:"title",key:"title",width:250,fixed:"left",ellipsis:{showTitle:!1},render:(t,s)=>e.jsxs("div",{children:[e.jsx(P,{placement:"topLeft",title:t,children:e.jsx("div",{style:{fontWeight:500},children:t})}),e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["v",s.version," | ",s.fileFormat.toUpperCase()]})]})},{title:"类型",dataIndex:"type",key:"type",width:120,render:t=>e.jsx(N,{color:"blue",children:be(t)})},{title:"状态",dataIndex:"status",key:"status",width:100,render:t=>e.jsx(N,{color:ve(t),children:ye(t)})},{title:"审批状态",dataIndex:"approvalStatus",key:"approvalStatus",width:100,render:t=>e.jsx(N,{color:ge(t),children:we(t)})},{title:"优先级",dataIndex:"priority",key:"priority",width:80,render:t=>e.jsx(N,{color:Ie(t),children:fe(t)})},{title:"作者",dataIndex:"authorName",key:"authorName",width:100},{title:"审核人",dataIndex:"reviewerName",key:"reviewerName",width:100,render:e=>e||"-"},{title:"关联项目",dataIndex:"projectName",key:"projectName",width:150,ellipsis:!0},{title:"文件大小",dataIndex:"fileSize",key:"fileSize",width:100,render:e=>`${e.toFixed(1)} MB`},{title:"查看/下载",key:"stats",width:120,render:(t,s)=>e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"12px"},children:[e.jsx(z,{})," ",s.viewCount]}),e.jsxs("div",{style:{fontSize:"12px"},children:[e.jsx(d,{})," ",s.downloadCount]})]})},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:110,render:e=>m(e).format("MM-DD HH:mm")},{title:"操作",key:"action",width:200,fixed:"right",render:(t,s)=>e.jsxs(c,{size:"small",children:[e.jsx(P,{title:"查看详情",children:e.jsx(p,{type:"text",icon:e.jsx(z,{}),onClick:()=>De(s)})}),e.jsx(P,{title:"预览",children:e.jsx(p,{type:"text",icon:e.jsx(n,{}),onClick:()=>_e(s)})}),e.jsx(P,{title:"下载",children:e.jsx(p,{type:"text",icon:e.jsx(d,{}),onClick:()=>Ne(s)})}),"draft"===s.status&&e.jsx(P,{title:"编辑",children:e.jsx(p,{type:"text",icon:e.jsx(g,{}),onClick:()=>Ce(s)})}),("draft"===s.status||"rejected"===s.status)&&e.jsx(P,{title:"提交审核",children:e.jsx(p,{type:"text",icon:e.jsx(w,{}),onClick:()=>Te(s.id)})}),"under_review"===s.status&&s.reviewerId&&e.jsx(P,{title:"审核",children:e.jsx(p,{type:"text",icon:e.jsx(I,{}),onClick:()=>ke(s)})}),"approved"===s.status&&e.jsx(P,{title:"发布",children:e.jsx(p,{type:"text",icon:e.jsx(b,{}),onClick:()=>Ae(s.id)})}),e.jsx(q,{title:"确定要删除这个报告吗？",onConfirm:()=>Fe(s.id),okText:"确定",cancelText:"取消",children:e.jsx(P,{title:"删除",children:e.jsx(p,{type:"text",danger:!0,icon:e.jsx(Y,{})})})})]})}],Ce=e=>{ie(e),ne.setFieldsValue({...e,expiryDate:e.expiryDate?m(e.expiryDate):null,tags:e.tags}),X(!0)},De=e=>{ae(e),K(!0)},_e=e=>{ae(e),ee(!0)},Ne=e=>{Z(k.map(t=>t.id===e.id?{...t,downloadCount:t.downloadCount+1}:t)),M.success(`正在下载报告: ${e.title}`)},Te=async e=>{try{await new Promise(e=>setTimeout(e,500)),Z(k.map(t=>t.id===e?{...t,status:"under_review",approvalStatus:"pending",updatedAt:(new Date).toISOString()}:t)),M.success("报告已提交审核")}catch(t){M.error("提交审核失败")}},ke=e=>{ae(e),de.resetFields(),se(!0)},Ae=async e=>{try{await new Promise(e=>setTimeout(e,500)),Z(k.map(t=>t.id===e?{...t,status:"published",publishDate:(new Date).toISOString(),updatedAt:(new Date).toISOString()}:t)),M.success("报告已发布")}catch(t){M.error("发布报告失败")}},Fe=async e=>{try{await new Promise(e=>setTimeout(e,500)),Z(k.filter(t=>t.id!==e)),M.success("报告删除成功")}catch(t){M.error("删除报告失败")}},Me=k.filter(e=>{const t=!oe||e.title.toLowerCase().includes(oe.toLowerCase())||e.description.toLowerCase().includes(oe.toLowerCase())||e.authorName.toLowerCase().includes(oe.toLowerCase()),s=!he||e.status===he,l=!pe||e.type===pe;return t&&s&&l}),Pe={total:k.length,draft:k.filter(e=>"draft"===e.status).length,underReview:k.filter(e=>"under_review"===e.status).length,published:k.filter(e=>"published"===e.status).length,totalDownloads:k.reduce((e,t)=>e+t.downloadCount,0),totalViews:k.reduce((e,t)=>e+t.viewCount,0)};return e.jsxs("div",{children:[e.jsxs(l,{gutter:16,style:{marginBottom:16},children:[e.jsx(i,{span:6,children:e.jsx(r,{children:e.jsx(a,{title:"报告总数",value:Pe.total,prefix:e.jsx(n,{})})})}),e.jsx(i,{span:6,children:e.jsx(r,{children:e.jsx(a,{title:"待审核",value:Pe.underReview,valueStyle:{color:"#1890ff"}})})}),e.jsx(i,{span:6,children:e.jsx(r,{children:e.jsx(a,{title:"已发布",value:Pe.published,valueStyle:{color:"#52c41a"}})})}),e.jsx(i,{span:6,children:e.jsx(r,{children:e.jsx(a,{title:"总下载量",value:Pe.totalDownloads,prefix:e.jsx(d,{})})})})]}),e.jsx(r,{children:e.jsxs(o,{activeKey:je,onChange:me,children:[e.jsxs($,{tab:"报告管理",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(c,{children:[e.jsx(h.Search,{placeholder:"搜索报告标题、描述或作者",value:oe,onChange:e=>ce(e.target.value),style:{width:300}}),e.jsxs(x,{placeholder:"筛选状态",value:he,onChange:xe,style:{width:120},allowClear:!0,children:[e.jsx(R,{value:"draft",children:"草稿"}),e.jsx(R,{value:"under_review",children:"审核中"}),e.jsx(R,{value:"approved",children:"已批准"}),e.jsx(R,{value:"published",children:"已发布"}),e.jsx(R,{value:"rejected",children:"已拒绝"})]}),e.jsxs(x,{placeholder:"筛选类型",value:pe,onChange:ue,style:{width:150},allowClear:!0,children:[e.jsx(R,{value:"analysis_report",children:"分析报告"}),e.jsx(R,{value:"summary_report",children:"总结报告"}),e.jsx(R,{value:"quality_report",children:"质量报告"}),e.jsx(R,{value:"progress_report",children:"进度报告"}),e.jsx(R,{value:"final_report",children:"最终报告"})]}),e.jsx(p,{type:"primary",icon:e.jsx(u,{}),onClick:()=>{ie(null),ne.resetFields(),X(!0)},children:"创建报告"})]})}),e.jsx(j,{columns:Se,dataSource:Me,rowKey:"id",loading:U,scroll:{x:1800},pagination:{total:Me.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`}})]},"reports"),e.jsxs($,{tab:"报告模板",children:[e.jsx(v,{message:"报告模板管理",description:"管理不同类型的报告模板，支持自定义模板格式",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(l,{gutter:16,children:[e.jsx(i,{span:8,children:e.jsxs(r,{title:"16S rRNA分析报告模板",size:"small",hoverable:!0,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"适用场景:"})," 16S rRNA基因测序分析"]}),e.jsx("p",{children:e.jsx("strong",{children:"包含章节:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"项目概述"}),e.jsx("li",{children:"实验方法"}),e.jsx("li",{children:"数据质量评估"}),e.jsx("li",{children:"多样性分析"}),e.jsx("li",{children:"分类学分析"}),e.jsx("li",{children:"结论与建议"})]}),e.jsx(p,{type:"primary",size:"small",block:!0,children:"使用模板"})]})}),e.jsx(i,{span:8,children:e.jsxs(r,{title:"宏基因组分析报告模板",size:"small",hoverable:!0,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"适用场景:"})," 宏基因组shotgun测序分析"]}),e.jsx("p",{children:e.jsx("strong",{children:"包含章节:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"项目背景"}),e.jsx("li",{children:"测序策略"}),e.jsx("li",{children:"数据预处理"}),e.jsx("li",{children:"物种组成分析"}),e.jsx("li",{children:"功能基因分析"}),e.jsx("li",{children:"代谢通路分析"})]}),e.jsx(p,{type:"primary",size:"small",block:!0,children:"使用模板"})]})}),e.jsx(i,{span:8,children:e.jsxs(r,{title:"质量控制报告模板",size:"small",hoverable:!0,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"适用场景:"})," 实验质量控制报告"]}),e.jsx("p",{children:e.jsx("strong",{children:"包含章节:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"质控标准"}),e.jsx("li",{children:"样本质量评估"}),e.jsx("li",{children:"测序质量分析"}),e.jsx("li",{children:"数据质量统计"}),e.jsx("li",{children:"质控结论"}),e.jsx("li",{children:"改进建议"})]}),e.jsx(p,{type:"primary",size:"small",block:!0,children:"使用模板"})]})})]})]},"templates"),e.jsxs($,{tab:"审核流程",children:[e.jsx(v,{message:"报告审核流程",description:"标准化的报告审核流程，确保报告质量",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(y,{direction:"vertical",current:-1,items:[{title:"创建草稿",description:"作者创建报告草稿，填写基本信息和内容",icon:e.jsx(g,{})},{title:"提交审核",description:"作者完成报告后提交给指定审核人员",icon:e.jsx(w,{})},{title:"专业审核",description:"审核人员检查报告内容、数据准确性和格式规范",icon:e.jsx(I,{})},{title:"修改完善",description:"根据审核意见修改报告内容（如需要）",icon:e.jsx(g,{})},{title:"批准发布",description:"审核通过后，报告获得批准并可以发布",icon:e.jsx(f,{})},{title:"公开发布",description:"将批准的报告发布给相关人员或公开访问",icon:e.jsx(b,{})}]})]},"workflow")]})}),e.jsx(S,{title:le?"编辑报告":"创建报告",open:V,onCancel:()=>{X(!1),ne.resetFields()},footer:null,width:800,children:e.jsxs(s,{form:ne,layout:"vertical",onFinish:async e=>{try{W(!0),await new Promise(e=>setTimeout(e,1e3));const t={...e,expiryDate:e.expiryDate?e.expiryDate.format("YYYY-MM-DD"):null,version:le?le.version:"1.0",fileSize:3*Math.random()+1,downloadCount:0,viewCount:0,approvalStatus:"not_submitted"};if(le){const e={...le,...t,updatedAt:(new Date).toISOString()};Z(k.map(t=>t.id===le.id?e:t)),M.success("报告更新成功")}else{const e={id:Date.now().toString(),...t,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};Z([...k,e]),M.success("报告创建成功")}X(!1),ne.resetFields()}catch(t){M.error("操作失败")}finally{W(!1)}},children:[e.jsxs(l,{gutter:16,children:[e.jsx(i,{span:12,children:e.jsx(s.Item,{name:"title",label:"报告标题",rules:[{required:!0,message:"请输入报告标题"}],children:e.jsx(h,{placeholder:"请输入报告标题"})})}),e.jsx(i,{span:12,children:e.jsx(s.Item,{name:"type",label:"报告类型",rules:[{required:!0,message:"请选择报告类型"}],children:e.jsxs(x,{placeholder:"请选择报告类型",children:[e.jsx(R,{value:"analysis_report",children:"分析报告"}),e.jsx(R,{value:"summary_report",children:"总结报告"}),e.jsx(R,{value:"quality_report",children:"质量报告"}),e.jsx(R,{value:"progress_report",children:"进度报告"}),e.jsx(R,{value:"final_report",children:"最终报告"})]})})})]}),e.jsx(s.Item,{name:"description",label:"报告描述",rules:[{required:!0,message:"请输入报告描述"}],children:e.jsx(B,{rows:3,placeholder:"请输入报告描述"})}),e.jsxs(l,{gutter:16,children:[e.jsx(i,{span:8,children:e.jsx(s.Item,{name:"priority",label:"优先级",rules:[{required:!0,message:"请选择优先级"}],children:e.jsxs(x,{placeholder:"请选择优先级",children:[e.jsx(R,{value:"high",children:"高"}),e.jsx(R,{value:"medium",children:"中"}),e.jsx(R,{value:"low",children:"低"})]})})}),e.jsx(i,{span:8,children:e.jsx(s.Item,{name:"projectId",label:"关联项目",rules:[{required:!0,message:"请选择关联项目"}],children:e.jsx(x,{placeholder:"请选择关联项目",children:H.map(t=>e.jsx(R,{value:t.id,children:t.name},t.id))})})}),e.jsx(i,{span:8,children:e.jsx(s.Item,{name:"analysisTaskId",label:"关联分析任务",children:e.jsx(x,{placeholder:"请选择关联分析任务",allowClear:!0,children:O.map(t=>e.jsx(R,{value:t.id,children:t.name},t.id))})})})]}),e.jsxs(l,{gutter:16,children:[e.jsx(i,{span:12,children:e.jsx(s.Item,{name:"templateId",label:"报告模板",rules:[{required:!0,message:"请选择报告模板"}],children:e.jsxs(x,{placeholder:"请选择报告模板",children:[e.jsx(R,{value:"template_16s",children:"16S rRNA分析报告模板"}),e.jsx(R,{value:"template_metagenome",children:"宏基因组分析报告模板"}),e.jsx(R,{value:"template_dual",children:"双重测序分析报告模板"}),e.jsx(R,{value:"template_quality",children:"质量控制报告模板"})]})})}),e.jsx(i,{span:12,children:e.jsx(s.Item,{name:"reviewerId",label:"指定审核人",children:e.jsxs(x,{placeholder:"请选择审核人",allowClear:!0,children:[e.jsx(R,{value:"2",children:"李四"}),e.jsx(R,{value:"5",children:"孙七"}),e.jsx(R,{value:"6",children:"周八"})]})})})]}),e.jsxs(l,{gutter:16,children:[e.jsx(i,{span:8,children:e.jsx(s.Item,{name:"fileFormat",label:"文件格式",rules:[{required:!0,message:"请选择文件格式"}],children:e.jsxs(x,{placeholder:"请选择文件格式",children:[e.jsx(R,{value:"pdf",children:"PDF"}),e.jsx(R,{value:"docx",children:"Word文档"}),e.jsx(R,{value:"html",children:"HTML"})]})})}),e.jsx(i,{span:8,children:e.jsx(s.Item,{name:"language",label:"报告语言",rules:[{required:!0,message:"请选择报告语言"}],children:e.jsxs(x,{placeholder:"请选择报告语言",children:[e.jsx(R,{value:"zh-CN",children:"中文"}),e.jsx(R,{value:"en-US",children:"英文"})]})})}),e.jsx(i,{span:8,children:e.jsx(s.Item,{name:"expiryDate",label:"有效期至",children:e.jsx(C,{style:{width:"100%"},placeholder:"请选择有效期"})})})]}),e.jsxs(l,{gutter:16,children:[e.jsx(i,{span:12,children:e.jsx(s.Item,{name:"isPublic",label:"公开访问",valuePropName:"checked",children:e.jsx(D,{checkedChildren:"是",unCheckedChildren:"否"})})}),e.jsx(i,{span:12,children:e.jsx(s.Item,{name:"status",label:"报告状态",rules:[{required:!0,message:"请选择报告状态"}],children:e.jsxs(x,{placeholder:"请选择报告状态",children:[e.jsx(R,{value:"draft",children:"草稿"}),e.jsx(R,{value:"under_review",children:"审核中"}),e.jsx(R,{value:"approved",children:"已批准"}),e.jsx(R,{value:"published",children:"已发布"})]})})})]}),e.jsx(s.Item,{name:"tags",label:"标签",children:e.jsx(x,{mode:"tags",placeholder:"请输入标签，按回车添加",style:{width:"100%"}})}),e.jsx(s.Item,{name:"authorId",label:"报告作者",rules:[{required:!0,message:"请选择报告作者"}],children:e.jsxs(x,{placeholder:"请选择报告作者",children:[e.jsx(R,{value:"3",children:"王五"}),e.jsx(R,{value:"4",children:"赵六"}),e.jsx(R,{value:"5",children:"孙七"})]})}),e.jsx(s.Item,{style:{textAlign:"right",marginBottom:0},children:e.jsxs(c,{children:[e.jsx(p,{onClick:()=>X(!1),children:"取消"}),e.jsx(p,{type:"primary",htmlType:"submit",loading:U,children:le?"更新":"创建"})]})})]})}),e.jsx(S,{title:"报告详情",open:J,onCancel:()=>K(!1),footer:[e.jsx(p,{onClick:()=>K(!1),children:"关闭"},"close")],width:900,children:re&&e.jsxs("div",{children:[e.jsxs(_,{bordered:!0,column:2,children:[e.jsx(_.Item,{label:"报告标题",children:re.title}),e.jsx(_.Item,{label:"报告类型",children:e.jsx(N,{color:"blue",children:be(re.type)})}),e.jsx(_.Item,{label:"状态",children:e.jsx(N,{color:ve(re.status),children:ye(re.status)})}),e.jsx(_.Item,{label:"审批状态",children:e.jsx(N,{color:ge(re.approvalStatus),children:we(re.approvalStatus)})}),e.jsx(_.Item,{label:"优先级",children:e.jsx(N,{color:Ie(re.priority),children:fe(re.priority)})}),e.jsxs(_.Item,{label:"版本",children:["v",re.version]}),e.jsx(_.Item,{label:"作者",children:re.authorName}),e.jsx(_.Item,{label:"审核人",children:re.reviewerName||"未指定"}),e.jsx(_.Item,{label:"关联项目",children:re.projectName}),e.jsx(_.Item,{label:"关联分析任务",children:re.analysisTaskName||"无"}),e.jsx(_.Item,{label:"文件格式",children:re.fileFormat.toUpperCase()}),e.jsxs(_.Item,{label:"文件大小",children:[re.fileSize.toFixed(1)," MB"]}),e.jsx(_.Item,{label:"查看次数",children:re.viewCount}),e.jsx(_.Item,{label:"下载次数",children:re.downloadCount}),e.jsx(_.Item,{label:"公开访问",children:re.isPublic?"是":"否"}),e.jsx(_.Item,{label:"有效期至",children:re.expiryDate||"无限制"})]}),e.jsx(T,{}),e.jsxs(_,{bordered:!0,column:1,children:[e.jsx(_.Item,{label:"报告描述",children:re.description}),re.reviewComments&&e.jsx(_.Item,{label:"审核意见",children:re.reviewComments})]}),re.tags&&re.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsx(Q,{level:5,children:"标签"}),e.jsx(c,{wrap:!0,children:re.tags.map((t,s)=>e.jsx(N,{color:"blue",children:t},s))})]}),e.jsx(T,{}),e.jsx(Q,{level:5,children:"时间线"}),e.jsxs(A,{children:[e.jsxs(A.Item,{color:"green",children:[e.jsx("strong",{children:"创建时间:"})," ",m(re.createdAt).format("YYYY-MM-DD HH:mm")]}),re.reviewDate&&e.jsxs(A.Item,{color:"blue",children:[e.jsx("strong",{children:"审核时间:"})," ",m(re.reviewDate).format("YYYY-MM-DD HH:mm")]}),re.publishDate&&e.jsxs(A.Item,{color:"cyan",children:[e.jsx("strong",{children:"发布时间:"})," ",m(re.publishDate).format("YYYY-MM-DD HH:mm")]}),e.jsxs(A.Item,{color:"gray",children:[e.jsx("strong",{children:"最后更新:"})," ",m(re.updatedAt).format("YYYY-MM-DD HH:mm")]})]})]})}),e.jsx(S,{title:"报告预览",open:G,onCancel:()=>ee(!1),footer:[e.jsx(p,{type:"primary",icon:e.jsx(d,{}),children:"下载报告"},"download"),e.jsx(p,{onClick:()=>ee(!1),children:"关闭"},"close")],width:1e3,children:re&&e.jsxs("div",{style:{height:600,border:"1px solid #d9d9d9",padding:16},children:[e.jsx(v,{message:`报告预览: ${re.title}`,description:`版本: v${re.version} | 格式: ${re.fileFormat.toUpperCase()} | 大小: ${re.fileSize.toFixed(1)} MB`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs("div",{style:{textAlign:"center",padding:"100px 0",color:"#999"},children:[e.jsx(n,{style:{fontSize:64,marginBottom:16}}),e.jsx("div",{children:"报告预览功能开发中..."}),e.jsx("div",{style:{marginTop:8},children:"支持 PDF、Word、HTML 格式的在线预览"})]})]})}),e.jsx(S,{title:"报告审核",open:te,onCancel:()=>{se(!1),de.resetFields()},footer:null,width:600,children:re&&e.jsxs("div",{children:[e.jsx(v,{message:`审核报告: ${re.title}`,description:`作者: ${re.authorName} | 版本: v${re.version}`,type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsxs(s,{form:de,layout:"vertical",onFinish:async e=>{try{if(W(!0),await new Promise(e=>setTimeout(e,1e3)),re){const t={...re,approvalStatus:e.decision,status:"approved"===e.decision?"approved":"rejected",reviewComments:e.comments,reviewDate:(new Date).toISOString(),updatedAt:(new Date).toISOString()};Z(k.map(e=>e.id===re.id?t:e)),M.success("报告审核"+("approved"===e.decision?"通过":"拒绝"))}se(!1),de.resetFields()}catch(t){M.error("审核操作失败")}finally{W(!1)}},children:[e.jsx(s.Item,{name:"decision",label:"审核决定",rules:[{required:!0,message:"请选择审核决定"}],children:e.jsxs(F.Group,{children:[e.jsx(F,{value:"approved",children:"批准"}),e.jsx(F,{value:"rejected",children:"拒绝"})]})}),e.jsx(s.Item,{name:"comments",label:"审核意见",rules:[{required:!0,message:"请输入审核意见"}],children:e.jsx(B,{rows:4,placeholder:"请输入详细的审核意见和建议"})}),e.jsx(s.Item,{style:{textAlign:"right",marginBottom:0},children:e.jsxs(c,{children:[e.jsx(p,{onClick:()=>se(!1),children:"取消"}),e.jsx(p,{type:"primary",htmlType:"submit",loading:U,children:"提交审核"})]})})]})]})})]})};export{V as default};
