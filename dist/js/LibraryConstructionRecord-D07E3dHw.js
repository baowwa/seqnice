import{j as e}from"./index-B3ZSLooO.js";import{r as i}from"./react-vendor-BSBC8BLg.js";import{$ as r,a as n,c as t,d as s,T as l,aT as a,S as d,B as o,ar as c,a1 as m,Q as x,aE as h,Z as j,aU as u,y as p,am as g,X as y,n as f,a7 as b,a2 as v,a9 as I,a4 as C,V as D,O as S,aS as w,af as N,aI as k,ac as z,az as A,A as T,a5 as q,a3 as M,l as P,at as B,D as F,b as L,ai as Y,al as _,ag as V,aq as $,ah as O,s as R}from"./antd-vendor-BuqAAsAf.js";const{Title:H,Text:K,Paragraph:E}=l,{Option:X}=C,{TextArea:Q}=M,{TabPane:G}=g,{Panel:J}=k,{Step:U}=b,Z=()=>{const[l,E]=i.useState(!1),[Z,W]=i.useState("basic"),[ee,ie]=i.useState([]),[re,ne]=i.useState(null),[te,se]=i.useState([]),[le,ae]=i.useState([]),[de,oe]=i.useState(null),[ce,me]=i.useState(!1),[xe,he]=i.useState(!1),[je,ue]=i.useState(!1),[pe,ge]=i.useState(!1),[ye,fe]=i.useState(!1),[be,ve]=i.useState(!1),[Ie]=r.useForm(),[Ce]=r.useForm(),[De]=r.useForm(),[Se]=r.useForm(),[we]=r.useForm(),[Ne]=r.useForm(),ke=[{id:"lib_record_001",sampleId:"sample_001",sampleCode:"S001",sampleName:"土壤样本-1",inputDNAAmount:1e3,inputDNAConcentration:50.2,inputDNAVolume:20,inputDNAQuality:1.85,libraryConcentration:15.6,libraryVolume:50,libraryYield:780,fragmentSizeDistribution:{mean:420,median:415,mode:410,range:"200-800"},qcMethod:"bioanalyzer",qcConcentration:15.6,qcVolume:50,qcMolarity:45.2,peakSize:420,dnaIntegrity:8.5,adapterDimerPercent:2.1,qcStatus:"pass",operator:"李实验员",recordTime:"2024-01-16 16:30:00",verified:!0,notes:"文库构建成功，质量良好"},{id:"lib_record_002",sampleId:"sample_002",sampleCode:"S002",sampleName:"水样-1",inputDNAAmount:800,inputDNAConcentration:40.1,inputDNAVolume:20,inputDNAQuality:1.92,libraryConcentration:12.3,libraryVolume:50,libraryYield:615,fragmentSizeDistribution:{mean:380,median:375,mode:370,range:"180-750"},qcMethod:"bioanalyzer",qcConcentration:12.3,qcVolume:50,qcMolarity:35.8,peakSize:380,dnaIntegrity:7.8,adapterDimerPercent:3.2,qcStatus:"warning",qcNotes:"接头二聚体略高",operator:"李实验员",recordTime:"2024-01-16 16:30:00",verified:!0,notes:"文库构建成功，需注意接头二聚体"}],ze={id:"lib_params_001",libraryType:"illumina",constructionMethod:"tagmentation",kitName:"Nextera XT DNA Library Prep Kit",kitVersion:"v3",protocol:"Illumina Nextera XT Protocol",fragmentationMethod:"enzymatic",targetFragmentSize:400,fragmentationTime:5,fragmentationTemperature:55,adapterType:"Nextera XT Index Kit",adapterConcentration:"2.5 μM",ligationTime:5,ligationTemperature:55,pcrCycles:12,pcrPrimer:"Nextera PCR Primer Cocktail",pcrPolymerase:"Nextera PCR Master Mix",purificationMethod:"beads",beadRatio:.9,elutionVolume:50,environmentalConditions:{temperature:22,humidity:45,pressure:1013},operator:"李实验员",startTime:"2024-01-16 14:00:00",estimatedEndTime:"2024-01-16 18:00:00",notes:"标准Illumina文库构建流程"},Ae=[{id:"reagent_001",name:"Tagment DNA Buffer",type:"buffer",catalog:"15027866",lot:"LOT20240110",concentration:"5×",volume:10,supplier:"Illumina",expiryDate:"2024-12-31",storageCondition:"-20°C"},{id:"reagent_002",name:"Amplicon Tagment Mix",type:"enzyme",catalog:"15027865",lot:"LOT20240108",concentration:"1×",volume:5,supplier:"Illumina",expiryDate:"2024-12-31",storageCondition:"-20°C"},{id:"reagent_003",name:"Nextera PCR Master Mix",type:"enzyme",catalog:"15028267",lot:"LOT20240105",concentration:"2×",volume:15,supplier:"Illumina",expiryDate:"2024-12-31",storageCondition:"-20°C"},{id:"reagent_004",name:"AMPure XP Beads",type:"bead",catalog:"A63881",lot:"LOT20240112",concentration:"1×",volume:100,supplier:"Beckman Coulter",expiryDate:"2025-06-30",storageCondition:"4°C"}];i.useEffect(()=>{E(!0),setTimeout(()=>{ie(ke),ne(ze),se(Ae),E(!1)},1e3)},[]);const Te=e=>({pass:"success",warning:"warning",fail:"error",pending:"default"}[e]||"default"),qe=e=>({pass:"通过",warning:"警告",fail:"失败",pending:"待检"}[e]||e),Me=e=>({enzyme:"#52c41a",buffer:"#1890ff",adapter:"#722ed1",primer:"#fa8c16",bead:"#13c2c2",dye:"#eb2f96",other:"#666666"}[e]||"#666666"),Pe=e=>{oe(e||null),e?Ce.setFieldsValue({...e,recordTime:S(e.recordTime)}):Ce.resetFields(),me(!0)},Be=[{title:"样本编号",dataIndex:"sampleCode",key:"sampleCode",width:100,fixed:"left"},{title:"样本名称",dataIndex:"sampleName",key:"sampleName",width:150},{title:"输入DNA(ng)",dataIndex:"inputDNAAmount",key:"inputDNAAmount",width:100},{title:"输入浓度(ng/μL)",dataIndex:"inputDNAConcentration",key:"inputDNAConcentration",width:120,render:e=>e.toFixed(1)},{title:"文库浓度(ng/μL)",dataIndex:"libraryConcentration",key:"libraryConcentration",width:120,render:i=>e.jsx("span",{style:{color:i<2?"#ff4d4f":"#52c41a"},children:i.toFixed(1)})},{title:"文库产量(ng)",dataIndex:"libraryYield",key:"libraryYield",width:100},{title:"平均片段大小(bp)",dataIndex:["fragmentSizeDistribution","mean"],key:"fragmentSize",width:120},{title:"摩尔浓度(nM)",dataIndex:"qcMolarity",key:"qcMolarity",width:100,render:e=>e?e.toFixed(1):"-"},{title:"DNA完整性",dataIndex:"dnaIntegrity",key:"dnaIntegrity",width:100,render:i=>i?e.jsx("span",{style:{color:i<7?"#ff4d4f":"#52c41a"},children:i.toFixed(1)}):"-"},{title:"接头二聚体(%)",dataIndex:"adapterDimerPercent",key:"adapterDimerPercent",width:120,render:i=>i?e.jsxs("span",{style:{color:i>5?"#ff4d4f":"#52c41a"},children:[i.toFixed(1),"%"]}):"-"},{title:"质控状态",dataIndex:"qcStatus",key:"qcStatus",width:100,render:i=>e.jsx(y,{color:Te(i),children:qe(i)})},{title:"验证状态",dataIndex:"verified",key:"verified",width:100,render:i=>e.jsx(y,{color:i?"success":"warning",children:i?"已验证":"待验证"})},{title:"操作",key:"action",width:150,fixed:"right",render:(i,r)=>{const n=(e=>{const i=[];e.libraryConcentration<2&&i.push("文库浓度过低，可能影响测序质量");const r=.7*e.inputDNAAmount;if(e.libraryYield<.5*r&&i.push("文库产量过低，建议检查构建流程"),re){const r=re.targetFragmentSize,n=e.fragmentSizeDistribution.mean;Math.abs(n-r)>.3*r&&i.push("片段大小偏离目标值过多")}return e.adapterDimerPercent&&e.adapterDimerPercent>5&&i.push("接头二聚体含量过高，可能影响测序质量"),e.dnaIntegrity&&e.dnaIntegrity<7&&i.push("DNA完整性较低，建议重新构建"),{valid:0===i.length,errors:i}})(r);return e.jsxs(d,{children:[e.jsx(V,{title:n.valid?"数据正常":n.errors.join("; "),children:e.jsx(o,{type:"link",size:"small",icon:n.valid?e.jsx(j,{}):e.jsx($,{}),style:{color:n.valid?"#52c41a":"#ff4d4f"}})}),e.jsx(o,{type:"link",size:"small",icon:e.jsx(O,{}),onClick:()=>Pe(r),children:"查看"}),e.jsx(o,{type:"link",size:"small",icon:e.jsx(Y,{}),onClick:()=>Pe(r),children:"编辑"})]})}}],Fe=[{title:"试剂名称",dataIndex:"name",key:"name"},{title:"类型",dataIndex:"type",key:"type",render:i=>e.jsx(y,{color:Me(i),children:"enzyme"===i?"酶":"buffer"===i?"缓冲液":"adapter"===i?"接头":"primer"===i?"引物":"bead"===i?"磁珠":"dye"===i?"染料":"其他"})},{title:"货号",dataIndex:"catalog",key:"catalog"},{title:"批号",dataIndex:"lot",key:"lot"},{title:"浓度",dataIndex:"concentration",key:"concentration"},{title:"用量",dataIndex:"volume",key:"volume",render:e=>`${e} μL`},{title:"供应商",dataIndex:"supplier",key:"supplier"},{title:"有效期",dataIndex:"expiryDate",key:"expiryDate",render:i=>{const r=S(i).isBefore(S()),n=S(i).isBefore(S().add(30,"day"));return e.jsx("span",{style:{color:r?"#ff4d4f":n?"#faad14":"#52c41a"},children:i})}},{title:"操作",key:"action",render:(i,r)=>e.jsxs(d,{children:[e.jsx(o,{type:"link",size:"small",icon:e.jsx(Y,{}),children:"编辑"}),e.jsx(o,{type:"link",size:"small",icon:e.jsx(_,{}),danger:!0,children:"删除"})]})}];return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(n,{style:{marginBottom:24},children:e.jsxs(t,{gutter:16,align:"middle",children:[e.jsxs(s,{span:18,children:[e.jsxs(H,{level:3,style:{margin:0},children:[e.jsx(a,{style:{marginRight:8}}),"文库构建步骤记录"]}),e.jsx(K,{type:"secondary",children:"🧬 详细记录文库构建过程中的参数设置、质量检测和结果数据"})]}),e.jsx(s,{span:6,style:{textAlign:"right"},children:e.jsxs(d,{children:[e.jsx(o,{icon:e.jsx(c,{}),onClick:()=>fe(!0),children:"快速记录"}),e.jsx(o,{type:"primary",icon:e.jsx(m,{}),onClick:()=>Pe(),children:"新增记录"})]})})]})}),e.jsxs(t,{gutter:16,style:{marginBottom:24},children:[e.jsx(s,{span:6,children:e.jsx(n,{children:e.jsx(x,{title:"总样本数",value:ee.length,suffix:"个",valueStyle:{color:"#1890ff"},prefix:e.jsx(h,{})})})}),e.jsx(s,{span:6,children:e.jsx(n,{children:e.jsx(x,{title:"构建成功",value:ee.filter(e=>"pass"===e.qcStatus).length,suffix:"个",valueStyle:{color:"#52c41a"},prefix:e.jsx(j,{})})})}),e.jsx(s,{span:6,children:e.jsx(n,{children:e.jsx(x,{title:"平均产量",value:ee.length>0?(ee.reduce((e,i)=>e+i.libraryYield,0)/ee.length).toFixed(0):0,suffix:"ng",valueStyle:{color:"#722ed1"},prefix:e.jsx(u,{})})})}),e.jsx(s,{span:6,children:e.jsx(n,{children:e.jsx(x,{title:"平均浓度",value:ee.length>0?(ee.reduce((e,i)=>e+i.libraryConcentration,0)/ee.length).toFixed(1):0,suffix:"ng/μL",valueStyle:{color:"#fa8c16"},prefix:e.jsx(p,{})})})})]}),e.jsx(n,{children:e.jsxs(g,{activeKey:Z,onChange:W,children:[e.jsx(G,{tab:"基本信息",children:e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:16,children:e.jsx(n,{title:"文库构建参数",size:"small",extra:e.jsx(o,{type:"link",icon:e.jsx(f,{}),onClick:()=>he(!0),children:"设置参数"}),children:re&&e.jsxs(t,{gutter:16,children:[e.jsxs(s,{span:12,children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"文库类型："}),e.jsx(y,{color:"blue",children:(Ye=re.libraryType,{illumina:"Illumina",nanopore:"Oxford Nanopore",pacbio:"PacBio",ion_torrent:"Ion Torrent",custom:"自定义"}[Ye]||Ye)})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"构建方法："}),e.jsx(K,{children:(Le=re.constructionMethod,{tagmentation:"转座酶片段化",fragmentation:"物理片段化",pcr_free:"PCR-free",amplicon:"扩增子",targeted:"靶向捕获"}[Le]||Le)})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"试剂盒："}),e.jsx(K,{children:re.kitName})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"版本："}),e.jsx(K,{children:re.kitVersion})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"目标片段大小："}),e.jsxs(K,{children:[re.targetFragmentSize," bp"]})]})]}),e.jsxs(s,{span:12,children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"接头类型："}),e.jsx(K,{children:re.adapterType})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"接头浓度："}),e.jsx(K,{children:re.adapterConcentration})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"纯化方法："}),e.jsx(K,{children:"beads"===re.purificationMethod?"磁珠纯化":"column"===re.purificationMethod?"柱纯化":"胶回收"})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"洗脱体积："}),e.jsxs(K,{children:[re.elutionVolume," μL"]})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"操作员："}),e.jsx(K,{children:re.operator})]})]})]})})}),e.jsxs(s,{span:8,children:[e.jsx(n,{title:"构建流程",size:"small",children:e.jsxs(b,{direction:"vertical",size:"small",current:-1,children:[e.jsx(U,{title:"DNA质检",description:"检测输入DNA质量和浓度"}),e.jsx(U,{title:"片段化",description:"酶切或物理片段化"}),e.jsx(U,{title:"末端修复",description:"修复DNA末端"}),e.jsx(U,{title:"接头连接",description:"连接测序接头"}),e.jsx(U,{title:"PCR扩增",description:"扩增文库片段"}),e.jsx(U,{title:"纯化",description:"去除引物和二聚体"}),e.jsx(U,{title:"质量检测",description:"检测文库质量"})]})}),e.jsx(n,{title:"环境条件",size:"small",style:{marginTop:16},children:(null==re?void 0:re.environmentalConditions)&&e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"温度："}),e.jsxs(K,{children:[re.environmentalConditions.temperature,"°C"]})]}),e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"湿度："}),e.jsxs(K,{children:[re.environmentalConditions.humidity,"%"]})]}),re.environmentalConditions.pressure&&e.jsxs("div",{style:{marginBottom:8},children:[e.jsx(K,{strong:!0,children:"气压："}),e.jsxs(K,{children:[re.environmentalConditions.pressure,"hPa"]})]})]})})]})]})},"basic"),e.jsx(G,{tab:"试剂记录",children:e.jsxs(d,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:18,children:e.jsxs(d,{children:[e.jsx(o,{type:"primary",icon:e.jsx(m,{}),onClick:()=>ue(!0),children:"添加试剂"}),e.jsx(o,{icon:e.jsx(v,{}),children:"导入试剂清单"}),e.jsx(o,{icon:e.jsx(I,{}),children:"导出试剂清单"})]})}),e.jsx(s,{span:6,style:{textAlign:"right"},children:e.jsxs(C,{placeholder:"筛选试剂类型",style:{width:120},allowClear:!0,children:[e.jsx(X,{value:"enzyme",children:"酶"}),e.jsx(X,{value:"buffer",children:"缓冲液"}),e.jsx(X,{value:"adapter",children:"接头"}),e.jsx(X,{value:"primer",children:"引物"}),e.jsx(X,{value:"bead",children:"磁珠"})]})})]}),e.jsx(D,{size:"small",dataSource:te,columns:Fe,rowKey:"id",pagination:!1}),e.jsx(n,{title:"试剂使用统计",size:"small",children:e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:8,children:e.jsx(x,{title:"酶类试剂",value:te.filter(e=>"enzyme"===e.type).length,suffix:"种",valueStyle:{color:"#52c41a"}})}),e.jsx(s,{span:8,children:e.jsx(x,{title:"缓冲液",value:te.filter(e=>"buffer"===e.type).length,suffix:"种",valueStyle:{color:"#1890ff"}})}),e.jsx(s,{span:8,children:e.jsx(x,{title:"即将过期",value:te.filter(e=>S(e.expiryDate).isBefore(S().add(30,"day"))).length,suffix:"种",valueStyle:{color:"#faad14"}})})]})})]})},"reagents"),e.jsx(G,{tab:"样本记录",children:e.jsxs(d,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:18,children:e.jsxs(d,{children:[e.jsx(o,{type:"primary",icon:e.jsx(m,{}),onClick:()=>Pe(),children:"新增记录"}),e.jsx(o,{icon:e.jsx(w,{}),onClick:()=>ve(!0),children:"批量处理"}),e.jsx(o,{icon:e.jsx(v,{}),children:"导入数据"}),e.jsx(o,{icon:e.jsx(I,{}),children:"导出数据"}),e.jsx(o,{icon:e.jsx(N,{}),children:"打印报告"})]})}),e.jsx(s,{span:6,style:{textAlign:"right"},children:e.jsxs(C,{placeholder:"筛选状态",style:{width:120},allowClear:!0,children:[e.jsx(X,{value:"pass",children:"通过"}),e.jsx(X,{value:"warning",children:"警告"}),e.jsx(X,{value:"fail",children:"失败"}),e.jsx(X,{value:"pending",children:"待检"})]})})]}),e.jsx(D,{size:"small",dataSource:ee,columns:Be,rowKey:"id",scroll:{x:1800},pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`共 ${e} 条记录`},rowSelection:{selectedRowKeys:le,onChange:ae}})]})},"samples"),e.jsxs(G,{tab:"质量检测",children:[e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:12,children:e.jsx(n,{title:"质量统计",size:"small",children:e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:6,children:e.jsx(x,{title:"通过率",value:ee.length>0?(ee.filter(e=>"pass"===e.qcStatus).length/ee.length*100).toFixed(1):0,suffix:"%",valueStyle:{color:"#52c41a"}})}),e.jsx(s,{span:6,children:e.jsx(x,{title:"高质量",value:ee.filter(e=>e.libraryConcentration>=10&&(e.adapterDimerPercent||0)<=3).length,valueStyle:{color:"#52c41a"}})}),e.jsx(s,{span:6,children:e.jsx(x,{title:"中等质量",value:ee.filter(e=>e.libraryConcentration>=5&&e.libraryConcentration<10).length,valueStyle:{color:"#faad14"}})}),e.jsx(s,{span:6,children:e.jsx(x,{title:"低质量",value:ee.filter(e=>e.libraryConcentration<5).length,valueStyle:{color:"#ff7a45"}})})]})})}),e.jsx(s,{span:12,children:e.jsx(n,{title:"质量趋势",size:"small",children:e.jsx("div",{style:{height:200,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(K,{type:"secondary",children:"文库质量趋势图表"})})})})]}),e.jsx(n,{title:"质量详情",size:"small",style:{marginTop:16},children:e.jsxs(k,{children:[e.jsxs(J,{header:"浓度质控",children:[e.jsx(z,{message:"浓度质控标准",description:"文库浓度应≥2 ng/μL，推荐≥10 ng/μL以确保测序质量",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(A,{size:"small",dataSource:ee.filter(e=>e.libraryConcentration<2),renderItem:i=>e.jsxs(A.Item,{children:[e.jsx(A.Item.Meta,{avatar:e.jsx(T,{style:{backgroundColor:"#ff4d4f"},children:i.sampleCode}),title:`${i.sampleName} - ${i.libraryConcentration.toFixed(1)} ng/μL`,description:"浓度过低"}),e.jsx(y,{color:"error",children:"异常"})]})})]},"concentration"),e.jsxs(J,{header:"片段大小质控",children:[e.jsx(z,{message:"片段大小质控标准",description:"片段大小应在目标范围内(±30%)，分布应相对集中",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(A,{size:"small",dataSource:ee.filter(e=>{const i=(null==re?void 0:re.targetFragmentSize)||400;return Math.abs(e.fragmentSizeDistribution.mean-i)>.3*i}),renderItem:i=>e.jsxs(A.Item,{children:[e.jsx(A.Item.Meta,{avatar:e.jsx(T,{style:{backgroundColor:"#faad14"},children:i.sampleCode}),title:`${i.sampleName} - ${i.fragmentSizeDistribution.mean} bp`,description:`分布: ${i.fragmentSizeDistribution.range}`}),e.jsx(y,{color:"warning",children:"片段异常"})]})})]},"fragment"),e.jsxs(J,{header:"接头二聚体质控",children:[e.jsx(z,{message:"接头二聚体质控标准",description:"接头二聚体含量应≤5%，过高会影响测序数据质量",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(A,{size:"small",dataSource:ee.filter(e=>e.adapterDimerPercent&&e.adapterDimerPercent>5),renderItem:i=>{var r;return e.jsxs(A.Item,{children:[e.jsx(A.Item.Meta,{avatar:e.jsx(T,{style:{backgroundColor:"#ff4d4f"},children:i.sampleCode}),title:`${i.sampleName} - ${null==(r=i.adapterDimerPercent)?void 0:r.toFixed(1)}%`,description:"接头二聚体过高"}),e.jsx(y,{color:"error",children:"异常"})]})}})]},"adapter")]})})]},"quality")]})}),e.jsx(q,{title:de?"编辑文库记录":"新增文库记录",open:ce,onCancel:()=>{me(!1),oe(null),Ce.resetFields()},onOk:()=>Ce.submit(),confirmLoading:l,width:900,children:e.jsxs(r,{form:Ce,layout:"vertical",onFinish:async e=>{try{E(!0),await new Promise(e=>setTimeout(e,1e3));const i={...e,id:(null==de?void 0:de.id)||`lib_record_${Date.now()}`,recordTime:e.recordTime.format("YYYY-MM-DD HH:mm:ss"),verified:!1,fragmentSizeDistribution:{mean:e.fragmentSizeMean||0,median:e.fragmentSizeMedian||0,mode:e.fragmentSizeMode||0,range:e.fragmentSizeRange||""}};de?(ie(e=>e.map(e=>e.id===de.id?i:e)),R.success("记录更新成功")):(ie(e=>[...e,i]),R.success("记录添加成功")),me(!1),oe(null),Ce.resetFields()}catch(i){R.error("保存失败，请重试")}finally{E(!1)}},children:[e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"sampleCode",label:"样本编号",rules:[{required:!0,message:"请输入样本编号"}],children:e.jsx(M,{placeholder:"请输入样本编号"})})}),e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"sampleName",label:"样本名称",rules:[{required:!0,message:"请输入样本名称"}],children:e.jsx(M,{placeholder:"请输入样本名称"})})})]}),e.jsx(P,{children:"输入DNA信息"}),e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"inputDNAAmount",label:"输入DNA总量(ng)",rules:[{required:!0,message:"请输入DNA总量"}],children:e.jsx(B,{placeholder:"请输入DNA总量",min:0,style:{width:"100%"}})})}),e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"inputDNAConcentration",label:"输入DNA浓度(ng/μL)",rules:[{required:!0,message:"请输入DNA浓度"}],children:e.jsx(B,{placeholder:"请输入DNA浓度",min:0,precision:1,style:{width:"100%"}})})}),e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"inputDNAVolume",label:"输入DNA体积(μL)",rules:[{required:!0,message:"请输入DNA体积"}],children:e.jsx(B,{placeholder:"请输入DNA体积",min:0,precision:1,style:{width:"100%"}})})})]}),e.jsx(P,{children:"文库构建结果"}),e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"libraryConcentration",label:"文库浓度(ng/μL)",rules:[{required:!0,message:"请输入文库浓度"}],children:e.jsx(B,{placeholder:"请输入文库浓度",min:0,precision:1,style:{width:"100%"}})})}),e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"libraryVolume",label:"文库体积(μL)",rules:[{required:!0,message:"请输入文库体积"}],children:e.jsx(B,{placeholder:"请输入文库体积",min:0,precision:1,style:{width:"100%"}})})}),e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"libraryYield",label:"文库产量(ng)",rules:[{required:!0,message:"请输入文库产量"}],children:e.jsx(B,{placeholder:"请输入文库产量",min:0,style:{width:"100%"}})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"fragmentSizeMean",label:"平均片段大小(bp)",children:e.jsx(B,{placeholder:"请输入平均片段大小",min:0,style:{width:"100%"}})})}),e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"qcMolarity",label:"摩尔浓度(nM)",children:e.jsx(B,{placeholder:"请输入摩尔浓度",min:0,precision:1,style:{width:"100%"}})})}),e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"adapterDimerPercent",label:"接头二聚体(%)",children:e.jsx(B,{placeholder:"请输入接头二聚体百分比",min:0,max:100,precision:1,style:{width:"100%"}})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"qcStatus",label:"质控状态",rules:[{required:!0,message:"请选择质控状态"}],children:e.jsxs(C,{placeholder:"请选择质控状态",children:[e.jsx(X,{value:"pass",children:"通过"}),e.jsx(X,{value:"warning",children:"警告"}),e.jsx(X,{value:"fail",children:"失败"}),e.jsx(X,{value:"pending",children:"待检"})]})})}),e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"operator",label:"操作员",rules:[{required:!0,message:"请输入操作员"}],children:e.jsx(M,{placeholder:"请输入操作员"})})})]}),e.jsx(r.Item,{name:"notes",label:"备注",children:e.jsx(Q,{rows:3,placeholder:"请输入备注信息"})})]})}),e.jsx(q,{title:"文库构建参数设置",open:xe,onCancel:()=>he(!1),onOk:()=>De.submit(),confirmLoading:l,width:800,children:e.jsxs(r,{form:De,layout:"vertical",onFinish:async e=>{try{E(!0),await new Promise(e=>setTimeout(e,1e3)),ne({...e,startTime:e.startTime.format("YYYY-MM-DD HH:mm:ss"),estimatedEndTime:e.estimatedEndTime.format("YYYY-MM-DD HH:mm:ss"),environmentalConditions:{temperature:e.temperature||22,humidity:e.humidity||45,pressure:e.pressure}}),R.success("构建参数设置成功"),he(!1)}catch(i){R.error("设置失败，请重试")}finally{E(!1)}},initialValues:re,children:[e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"libraryType",label:"文库类型",rules:[{required:!0,message:"请选择文库类型"}],children:e.jsxs(C,{placeholder:"请选择文库类型",children:[e.jsx(X,{value:"illumina",children:"Illumina"}),e.jsx(X,{value:"nanopore",children:"Oxford Nanopore"}),e.jsx(X,{value:"pacbio",children:"PacBio"}),e.jsx(X,{value:"ion_torrent",children:"Ion Torrent"}),e.jsx(X,{value:"custom",children:"自定义"})]})})}),e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"constructionMethod",label:"构建方法",rules:[{required:!0,message:"请选择构建方法"}],children:e.jsxs(C,{placeholder:"请选择构建方法",children:[e.jsx(X,{value:"tagmentation",children:"转座酶片段化"}),e.jsx(X,{value:"fragmentation",children:"物理片段化"}),e.jsx(X,{value:"pcr_free",children:"PCR-free"}),e.jsx(X,{value:"amplicon",children:"扩增子"}),e.jsx(X,{value:"targeted",children:"靶向捕获"})]})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"kitName",label:"试剂盒名称",rules:[{required:!0,message:"请输入试剂盒名称"}],children:e.jsx(M,{placeholder:"请输入试剂盒名称"})})}),e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"targetFragmentSize",label:"目标片段大小(bp)",rules:[{required:!0,message:"请输入目标片段大小"}],children:e.jsx(B,{placeholder:"请输入目标片段大小",min:50,max:1e4,style:{width:"100%"}})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"purificationMethod",label:"纯化方法",rules:[{required:!0,message:"请选择纯化方法"}],children:e.jsxs(C,{placeholder:"请选择纯化方法",children:[e.jsx(X,{value:"beads",children:"磁珠纯化"}),e.jsx(X,{value:"column",children:"柱纯化"}),e.jsx(X,{value:"gel",children:"胶回收"})]})})}),e.jsx(s,{span:12,children:e.jsx(r.Item,{name:"elutionVolume",label:"洗脱体积(μL)",rules:[{required:!0,message:"请输入洗脱体积"}],children:e.jsx(B,{placeholder:"请输入洗脱体积",min:10,max:200,style:{width:"100%"}})})})]}),e.jsxs(t,{gutter:16,children:[e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"temperature",label:"环境温度(°C)",children:e.jsx(B,{placeholder:"请输入环境温度",min:15,max:30,style:{width:"100%"}})})}),e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"humidity",label:"环境湿度(%)",children:e.jsx(B,{placeholder:"请输入环境湿度",min:30,max:70,style:{width:"100%"}})})}),e.jsx(s,{span:8,children:e.jsx(r.Item,{name:"operator",label:"操作员",rules:[{required:!0,message:"请输入操作员"}],children:e.jsx(M,{placeholder:"请输入操作员"})})})]}),e.jsx(r.Item,{name:"notes",label:"备注",children:e.jsx(Q,{rows:3,placeholder:"请输入备注信息"})})]})}),e.jsx(F,{title:"快速记录",placement:"right",width:400,open:ye,onClose:()=>fe(!1),children:e.jsxs(r,{form:Ne,layout:"vertical",onFinish:async e=>{try{E(!0),await new Promise(e=>setTimeout(e,500)),R.success("快速记录成功"),fe(!1),Ne.resetFields()}catch(i){R.error("记录失败，请重试")}finally{E(!1)}},children:[e.jsx(r.Item,{name:"sampleCode",label:"样本编号",rules:[{required:!0,message:"请输入样本编号"}],children:e.jsx(M,{placeholder:"扫描或输入样本编号"})}),e.jsx(r.Item,{name:"libraryConcentration",label:"文库浓度(ng/μL)",rules:[{required:!0,message:"请输入文库浓度"}],children:e.jsx(B,{placeholder:"请输入文库浓度",min:0,precision:1,style:{width:"100%"}})}),e.jsx(r.Item,{name:"qcStatus",label:"质控状态",rules:[{required:!0,message:"请选择质控状态"}],children:e.jsxs(L.Group,{children:[e.jsx(L.Button,{value:"pass",children:"通过"}),e.jsx(L.Button,{value:"warning",children:"警告"}),e.jsx(L.Button,{value:"fail",children:"失败"})]})}),e.jsx(r.Item,{name:"notes",label:"备注",children:e.jsx(Q,{rows:2,placeholder:"请输入备注"})}),e.jsx(r.Item,{children:e.jsx(o,{type:"primary",htmlType:"submit",block:!0,loading:l,children:"保存记录"})})]})})]});var Le,Ye};export{Z as default};
