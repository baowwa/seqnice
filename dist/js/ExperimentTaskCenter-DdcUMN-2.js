import{j as e}from"./index-BLG7Shib.js";import{u as s,r as t}from"./react-vendor-CntIoGE-.js";import{$ as a,s as l,c as i,d as r,a as n,T as d,G as c,S as o,B as p,a1 as m,a2 as h,af as x,a8 as j,am as u,V as y,ay as g,Y as S,ao as T,ad as C,Q as b,az as f,X as k,a5 as z,a3 as v,a6 as D,b as w,ac as I,D as N,ai as _,aA as Y,n as R,aB as $,Z as B,a4 as E,aC as P,O as M,at as q,aa as H,aD as X}from"./antd-vendor-D5rArj2z.js";const{Title:A,Text:F,Paragraph:K}=d,{Option:O}=E,{TextArea:Q}=v,V=()=>{s();const[d]=a.useForm(),[K]=a.useForm(),[V,G]=t.useState("unassigned"),[J,L]=t.useState(!1),[Z,U]=t.useState([]),[W,ee]=t.useState(!1),[se,te]=t.useState(!1),[ae,le]=t.useState(!1),[ie,re]=t.useState(!1),[ne,de]=t.useState(null),[ce,oe]=t.useState(null),[pe,me]=t.useState(null),[he,xe]=t.useState([]),[je,ue]=t.useState([]),[ye,ge]=t.useState([]);t.useEffect(()=>{Se()},[]);const Se=async()=>{L(!0);try{const e=[{id:"S001",sampleCode:"S001",sampleName:"Ê†∑Êú¨1",sampleType:"DNA",status:"received",receivedDate:"2024-05-20",projectName:"ËÇøÁò§ÊµãÂ∫èÈ°πÁõÆ",priority:"high"},{id:"S002",sampleCode:"S002",sampleName:"Ê†∑Êú¨2",sampleType:"RNA",status:"received",receivedDate:"2024-05-20",projectName:"ËÇøÁò§ÊµãÂ∫èÈ°πÁõÆ",priority:"medium"},{id:"S003",sampleCode:"S003",sampleName:"Ê†∑Êú¨3",sampleType:"DNA",status:"received",receivedDate:"2024-05-20",projectName:"ËÇøÁò§ÊµãÂ∫èÈ°πÁõÆ",priority:"high"},{id:"S004",sampleCode:"S004",sampleName:"Ê†∑Êú¨4",sampleType:"DNA",status:"received",receivedDate:"2024-05-20",projectName:"Âü∫Âõ†Ê£ÄÊµãÈ°πÁõÆ",priority:"low"}],s=[{id:"EXP001",batchCode:"EXP_20240520_001",batchName:"ËÇøÁò§Âü∫Âõ†Ê£ÄÊµãÊâπÊ¨°-20240520",status:"in_progress",sampleCount:3,samples:e.slice(0,3),operator:"Âº†‰∏â",project:"ËÇøÁò§ÊµãÂ∫èÈ°πÁõÆ",plannedStartDate:"2024-05-20 09:30",plannedEndDate:"2024-05-20 18:00",actualStartDate:"2024-05-20 09:30",priority:"high",createdBy:"Âº†‰∏â",createdTime:"2024-05-20 09:00",updatedTime:"2024-05-20 14:30",progress:60,currentStep:"PCRÊâ©Â¢û",steps:[{stepType:"sample_prep",stepName:"Ê†∑Êú¨ÂâçÂ§ÑÁêÜ",status:"completed",operator:"Âº†‰∏â",startTime:"09:30",endTime:"10:00",duration:30,dataRecorded:!0},{stepType:"nucleic_extraction",stepName:"Ê†∏ÈÖ∏ÊèêÂèñ",status:"completed",operator:"Âº†‰∏â",startTime:"10:00",endTime:"11:30",duration:90,dataRecorded:!0},{stepType:"pcr",stepName:"PCRÊâ©Â¢û",status:"in_progress",operator:"Âº†‰∏â",startTime:"14:30",dataRecorded:!1},{stepType:"library_prep",stepName:"ÊñáÂ∫ìÊûÑÂª∫",status:"pending",dataRecorded:!1},{stepType:"quantification",stepName:"ÊñáÂ∫ìÂÆöÈáè",status:"pending",dataRecorded:!1},{stepType:"qc",stepName:"ÊúÄÁªàQC",status:"pending",dataRecorded:!1}]},{id:"EXP002",batchCode:"EXP_20240519_002",batchName:"ÂúüÂ£§ÂæÆÁîüÁâ©Â§öÊ†∑ÊÄßÊµãÂ∫è",status:"in_progress",sampleCount:12,samples:[],operator:"ÊùéÂõõ",project:"ÁéØÂ¢ÉÂæÆÁîüÁâ©È°πÁõÆ",plannedStartDate:"2024-05-19 08:00",plannedEndDate:"2024-05-20 17:00",actualStartDate:"2024-05-19 08:15",priority:"medium",createdBy:"ÊùéÂõõ",createdTime:"2024-05-19 07:30",updatedTime:"2024-05-20 10:00",progress:75,currentStep:"Ê†∑Êú¨Ë¥®Ê£Ä",steps:[]},{id:"EXP003",batchCode:"EXP_20240518_003",batchName:"Êµ∑Ê¥ãÂæÆÁîüÁâ©Â§öÊ†∑ÊÄßÂàÜÊûê",status:"in_progress",sampleCount:30,samples:[],operator:"Áéã‰∫î",project:"Êµ∑Ê¥ãÁîüÁâ©È°πÁõÆ",plannedStartDate:"2024-05-18 09:00",plannedEndDate:"2024-05-21 16:00",actualStartDate:"2024-05-18 09:20",priority:"low",createdBy:"Áéã‰∫î",createdTime:"2024-05-18 08:45",updatedTime:"2024-05-20 15:30",progress:85,currentStep:"Â∑≤ÂÆåÊàê",steps:[]}],t=[{id:"EXP004",batchCode:"EXP_20240517_004",batchName:"ÂÆåÊàêÁöÑÊµãÂ∫èÊâπÊ¨°Á§∫‰æã",status:"completed",sampleCount:8,samples:[],operator:"ËµµÂÖ≠",project:"Âü∫Âõ†Ê£ÄÊµãÈ°πÁõÆ",plannedStartDate:"2024-05-17 08:00",plannedEndDate:"2024-05-17 18:00",actualStartDate:"2024-05-17 08:10",actualEndDate:"2024-05-17 17:45",priority:"medium",createdBy:"ËµµÂÖ≠",createdTime:"2024-05-17 07:30",updatedTime:"2024-05-17 17:45",progress:100,currentStep:"Â∑≤ÂÆåÊàê",steps:[]}];xe(e),ue(s),ge(t)}catch(e){l.error("Êï∞ÊçÆÂä†ËΩΩÂ§±Ë¥•")}finally{L(!1)}},Te=()=>{0!==Z.length?ee(!0):l.warning("ËØ∑ÂÖàÈÄâÊã©Ë¶ÅÂä†ÂÖ•ÊâπÊ¨°ÁöÑÊ†∑Êú¨")},Ce=e=>{de(e),te(!0)},be=(e,s)=>{de(e),oe(s),le(!0);const t=fe(e.id,s);if(t)me(t),K.setFieldsValue(t);else{const t={id:`${e.id}_${s}_${Date.now()}`,batchId:e.id,stepType:s,operator:"ÂΩìÂâçÁî®Êà∑",startTime:M().format("YYYY-MM-DD HH:mm"),basicInfo:{},sampleData:{},parameters:{},qcResults:{},attachments:[],notes:"",isDraft:!0};me(t),K.setFieldsValue(t)}},fe=(e,s)=>{const t=`draft_${e}_${s}`,a=localStorage.getItem(t);return a?JSON.parse(a):null},ke=[{title:"Ê†∑Êú¨ÁºñÂè∑",dataIndex:"sampleCode",key:"sampleCode",width:120},{title:"Ê†∑Êú¨ÂêçÁß∞",dataIndex:"sampleName",key:"sampleName",width:150},{title:"Ê†∑Êú¨Á±ªÂûã",dataIndex:"sampleType",key:"sampleType",width:100,render:s=>e.jsx(k,{color:"DNA"===s?"blue":"RNA"===s?"green":"orange",children:s})},{title:"Êé•Êî∂Êó•Êúü",dataIndex:"receivedDate",key:"receivedDate",width:120},{title:"Êìç‰Ωú",key:"action",width:120,render:(s,t)=>e.jsx(p,{type:"link",size:"small",onClick:()=>U([...Z,t.id]),children:"Âä†ÂÖ•ÊâπÊ¨°"})}];return e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(i,{gutter:24,style:{marginBottom:24},children:[e.jsx(r,{span:18,children:e.jsxs(n,{children:[e.jsxs(A,{level:2,style:{margin:0},children:[e.jsx(c,{style:{marginRight:8}}),"ÂÆûÈ™å‰ªªÂä°‰∏≠ÂøÉ"]}),e.jsx(F,{type:"secondary",children:"ÁÆ°ÁêÜÂÆûÈ™åÊ†∑Êú¨ÂàÜÈÖç„ÄÅÊâπÊ¨°ÊâßË°åÂíåËøõÂ∫¶Ë∑üË∏™ÔºåÊîØÊåÅËØ¶ÁªÜÁöÑÊï∞ÊçÆËÆ∞ÂΩïÂäüËÉΩ"})]})}),e.jsx(r,{span:6,children:e.jsx(n,{title:"Âø´Êç∑Êìç‰Ωú",size:"small",children:e.jsxs(o,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(p,{type:"primary",icon:e.jsx(m,{}),onClick:Te,disabled:0===Z.length,block:!0,children:["ÂàõÂª∫Êñ∞ÊâπÊ¨° (",Z.length,")"]}),e.jsx(p,{icon:e.jsx(h,{}),block:!0,children:"ÊâπÈáèÂØºÂÖ•Ê†∑Êú¨"}),e.jsx(p,{icon:e.jsx(x,{}),block:!0,children:"ÊâìÂç∞Ê†áÁ≠æ"}),e.jsx(p,{icon:e.jsx(j,{}),block:!0,children:"ÂØºÂá∫Êï∞ÊçÆ"})]})})})]}),e.jsxs(i,{gutter:24,children:[e.jsx(r,{span:18,children:e.jsx(n,{children:e.jsx(u,{activeKey:V,onChange:G,items:[{key:"unassigned",label:`üîò ÂæÖÂàÜÈÖçÊ†∑Êú¨(${he.length})`,children:e.jsxs("div",{children:[e.jsx(y,{columns:ke,dataSource:he,rowKey:"id",loading:J,rowSelection:{selectedRowKeys:Z,onChange:e=>{U(e)},type:"checkbox"},pagination:{total:he.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:e=>`ÂÖ± ${e} ‰∏™Ê†∑Êú¨`}}),e.jsx("div",{style:{marginTop:16,textAlign:"center"},children:e.jsxs(o,{children:[e.jsx(g,{checked:Z.length===he.length&&he.length>0,indeterminate:Z.length>0&&Z.length<he.length,onChange:e=>{e.target.checked?U(he.map(e=>e.id)):U([])},children:"ÂÖ®ÈÄâ"}),e.jsxs(p,{type:"primary",size:"large",onClick:Te,disabled:0===Z.length,children:["ÂàõÂª∫Êñ∞ÊâπÊ¨°Âπ∂Âä†ÂÖ•ÈÄâ‰∏≠Ê†∑Êú¨(",Z.length,")"]})]})})]})},{key:"inProgress",label:`üîò ËøõË°å‰∏≠ÊâπÊ¨°(${je.length})`,children:e.jsx("div",{children:e.jsx(i,{gutter:16,children:je.map(s=>e.jsx(r,{span:12,style:{marginBottom:16},children:e.jsxs(n,{size:"small",title:e.jsxs("div",{children:[e.jsx(F,{strong:!0,children:s.batchCode}),e.jsx("br",{}),e.jsx(F,{type:"secondary",style:{fontSize:"12px"},children:s.batchName})]}),extra:e.jsx(C,{count:`${s.progress}%`,style:{backgroundColor:"#52c41a"}}),actions:[e.jsx(p,{type:"link",onClick:()=>Ce(s),children:"Êü•ÁúãËØ¶ÊÉÖ"},"view")],children:[e.jsx("div",{style:{marginBottom:8},children:e.jsx(S,{percent:s.progress,size:"small"})}),e.jsxs(T,{size:"small",column:1,children:[e.jsx(T.Item,{label:"ÂΩìÂâçÊ≠•È™§",children:e.jsx(F,{strong:!0,children:s.currentStep})}),e.jsx(T.Item,{label:"Ë¥üË¥£‰∫∫",children:s.operator}),e.jsxs(T.Item,{label:"Ê†∑Êú¨Êï∞",children:[s.sampleCount,"‰∏™"]}),e.jsx(T.Item,{label:"È°πÁõÆ",children:s.project})]})]})},s.id))})})},{key:"completed",label:`üîò Â∑≤ÂÆåÊàê(${ye.length})`,children:e.jsx("div",{children:e.jsx(y,{size:"small",dataSource:ye,rowKey:"id",columns:[{title:"ÊâπÊ¨°ÁºñÂè∑",dataIndex:"batchCode",key:"batchCode"},{title:"ÊâπÊ¨°ÂêçÁß∞",dataIndex:"batchName",key:"batchName"},{title:"Ê†∑Êú¨Êï∞",dataIndex:"sampleCount",key:"sampleCount",render:e=>`${e}‰∏™`},{title:"ÂÆåÊàêÊó∂Èó¥",dataIndex:"actualEndDate",key:"actualEndDate"},{title:"Êìç‰Ωú",key:"action",render:(s,t)=>e.jsxs(o,{children:[e.jsx(p,{type:"link",size:"small",onClick:()=>Ce(t),children:"Êü•ÁúãËØ¶ÊÉÖ"}),e.jsx(p,{type:"link",size:"small",children:"ÂØºÂá∫Êä•Âëä"})]})}]})})}]})})}),e.jsx(r,{span:6,children:e.jsxs(o,{direction:"vertical",style:{width:"100%"},children:[e.jsxs(n,{title:"ÁªüËÆ°‰ø°ÊÅØ",size:"small",children:[e.jsx(b,{title:"ÂæÖÂàÜÈÖçÊ†∑Êú¨",value:he.length}),e.jsx(b,{title:"ËøõË°å‰∏≠ÊâπÊ¨°",value:je.length}),e.jsx(b,{title:"Â∑≤ÂÆåÊàêÊâπÊ¨°",value:ye.length})]}),e.jsx(n,{title:"ËØïÂâÇÁä∂ÊÄÅ",size:"small",children:e.jsx(f,{size:"small",dataSource:[{name:"PCR Mix",status:"ÂÖÖË∂≥",color:"green"},{name:"DNAÊèêÂèñËØïÂâÇ",status:"‰∏çË∂≥",color:"red"},{name:"Á£ÅÁè†",status:"ÂÖÖË∂≥",color:"green"}],renderItem:s=>e.jsxs(f.Item,{children:[e.jsx(F,{children:s.name}),e.jsx(k,{color:s.color,children:s.status})]})})}),e.jsx(n,{title:"‰ª™Âô®Áä∂ÊÄÅ",size:"small",children:e.jsx(f,{size:"small",dataSource:[{name:"PCR‰ª™-01",status:"Á©∫Èó≤",color:"green"},{name:"Á¶ªÂøÉÊú∫-02",status:"‰ΩøÁî®‰∏≠",color:"orange"},{name:"Ê∞¥Êµ¥ÈîÖ-03",status:"Á©∫Èó≤",color:"green"}],renderItem:s=>e.jsxs(f.Item,{children:[e.jsx(F,{children:s.name}),e.jsx(k,{color:s.color,children:s.status})]})})})]})})]}),e.jsx(z,{title:"ÂàõÂª∫Êñ∞ÊâπÊ¨°",open:W,onCancel:()=>ee(!1),onOk:()=>d.submit(),confirmLoading:J,width:600,children:e.jsxs(a,{form:d,layout:"vertical",onFinish:async e=>{L(!0);try{const s=he.filter(e=>Z.includes(e.id)),t={id:`EXP${Date.now()}`,batchCode:`EXP_${M().format("YYYYMMDD")}_${String(Math.floor(1e3*Math.random())).padStart(3,"0")}`,batchName:e.batchName,status:"ready",sampleCount:s.length,samples:s,operator:e.operator||"ÂΩìÂâçÁî®Êà∑",project:e.project,plannedStartDate:e.plannedStartDate.format("YYYY-MM-DD HH:mm"),plannedEndDate:e.plannedEndDate.format("YYYY-MM-DD HH:mm"),priority:e.priority,notes:e.notes,createdBy:"ÂΩìÂâçÁî®Êà∑",createdTime:M().format("YYYY-MM-DD HH:mm"),updatedTime:M().format("YYYY-MM-DD HH:mm"),progress:0,currentStep:"ÂæÖÂºÄÂßã",steps:[{stepType:"sample_prep",stepName:"Ê†∑Êú¨ÂâçÂ§ÑÁêÜ",status:"pending",dataRecorded:!1},{stepType:"nucleic_extraction",stepName:"Ê†∏ÈÖ∏ÊèêÂèñ",status:"pending",dataRecorded:!1},{stepType:"pcr",stepName:"PCRÊâ©Â¢û",status:"pending",dataRecorded:!1},{stepType:"library_prep",stepName:"ÊñáÂ∫ìÊûÑÂª∫",status:"pending",dataRecorded:!1},{stepType:"quantification",stepName:"ÊñáÂ∫ìÂÆöÈáè",status:"pending",dataRecorded:!1},{stepType:"qc",stepName:"ÊúÄÁªàQC",status:"pending",dataRecorded:!1}]};ue([...je,t]),xe(he.filter(e=>!Z.includes(e.id))),U([]),l.success("ÊâπÊ¨°ÂàõÂª∫ÊàêÂäüÔºÅ"),ee(!1),d.resetFields(),G("inProgress")}catch(s){l.error("ÊâπÊ¨°ÂàõÂª∫Â§±Ë¥•")}finally{L(!1)}},children:[e.jsx(a.Item,{name:"batchName",label:"ÊâπÊ¨°ÂêçÁß∞",rules:[{required:!0,message:"ËØ∑ËæìÂÖ•ÊâπÊ¨°ÂêçÁß∞"}],children:e.jsx(v,{placeholder:"ËØ∑ËæìÂÖ•ÊâπÊ¨°ÂêçÁß∞"})}),e.jsx(a.Item,{name:"project",label:"ÊâÄÂ±ûÈ°πÁõÆ",rules:[{required:!0,message:"ËØ∑ËæìÂÖ•ÊâÄÂ±ûÈ°πÁõÆ"}],children:e.jsx(v,{placeholder:"ËØ∑ËæìÂÖ•ÊâÄÂ±ûÈ°πÁõÆ"})}),e.jsxs(i,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"plannedStartDate",label:"ËÆ°ÂàíÂºÄÂßãÊó∂Èó¥",rules:[{required:!0,message:"ËØ∑ÈÄâÊã©ÂºÄÂßãÊó∂Èó¥"}],children:e.jsx(D,{showTime:!0,style:{width:"100%"},placeholder:"ÈÄâÊã©ÂºÄÂßãÊó∂Èó¥"})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"plannedEndDate",label:"ËÆ°ÂàíÁªìÊùüÊó∂Èó¥",rules:[{required:!0,message:"ËØ∑ÈÄâÊã©ÁªìÊùüÊó∂Èó¥"}],children:e.jsx(D,{showTime:!0,style:{width:"100%"},placeholder:"ÈÄâÊã©ÁªìÊùüÊó∂Èó¥"})})})]}),e.jsx(a.Item,{name:"priority",label:"‰ºòÂÖàÁ∫ß",rules:[{required:!0,message:"ËØ∑ÈÄâÊã©‰ºòÂÖàÁ∫ß"}],children:e.jsxs(w.Group,{children:[e.jsx(w,{value:"low",children:"‰Ωé"}),e.jsx(w,{value:"medium",children:"‰∏≠"}),e.jsx(w,{value:"high",children:"È´ò"}),e.jsx(w,{value:"urgent",children:"Á¥ßÊÄ•"})]})}),e.jsx(a.Item,{name:"notes",label:"Â§áÊ≥®",children:e.jsx(Q,{rows:3,placeholder:"ËØ∑ËæìÂÖ•Â§áÊ≥®‰ø°ÊÅØ"})}),e.jsx(I,{message:`Â∞ÜÂàõÂª∫ÂåÖÂê´ ${Z.length} ‰∏™Ê†∑Êú¨ÁöÑÊñ∞ÊâπÊ¨°`,type:"info",showIcon:!0,style:{marginTop:16}})]})}),e.jsx(N,{title:e.jsxs("div",{children:[e.jsx(p,{type:"text",icon:e.jsx(Y,{}),onClick:()=>te(!1),style:{marginRight:8}}),"ÂÆûÈ™åÊâπÊ¨°: ",null==ne?void 0:ne.batchCode,e.jsx(p,{type:"text",icon:e.jsx(R,{}),style:{marginLeft:8}})]}),placement:"right",width:900,open:se,onClose:()=>te(!1),children:ne&&e.jsxs("div",{children:[e.jsxs(n,{title:"ÊâπÊ¨°‰ø°ÊÅØ",size:"small",style:{marginBottom:16},children:[e.jsxs(i,{gutter:16,children:[e.jsx(r,{span:8,children:e.jsx(b,{title:"Áä∂ÊÄÅ",value:"üîÑ ËøõË°å‰∏≠",valueStyle:{fontSize:"16px"}})}),e.jsx(r,{span:8,children:e.jsx(b,{title:"Ë¥üË¥£‰∫∫",value:ne.operator,valueStyle:{fontSize:"16px"}})}),e.jsx(r,{span:8,children:e.jsx(b,{title:"ÂàõÂª∫Êó∂Èó¥",value:ne.createdTime,valueStyle:{fontSize:"16px"}})})]}),e.jsxs(i,{gutter:16,style:{marginTop:16},children:[e.jsx(r,{span:8,children:e.jsx(b,{title:"Ê†∑Êú¨Êï∞",value:`${ne.sampleCount}‰∏™`,valueStyle:{fontSize:"16px"}})}),e.jsx(r,{span:8,children:e.jsx(b,{title:"È°πÁõÆ",value:ne.project,valueStyle:{fontSize:"16px"}})}),e.jsx(r,{span:8,children:e.jsx(b,{title:"È¢ÑËÆ°ÂÆåÊàê",value:"‰ªäÂ§©",valueStyle:{fontSize:"16px"}})})]})]}),e.jsx(n,{title:"Ê≠•È™§Ë∑üË∏™",size:"small",style:{marginBottom:16},children:e.jsx("div",{style:{marginBottom:16},children:e.jsx(S,{percent:ne.progress,strokeColor:"#52c41a",format:e=>`${e}% ÂÆåÊàê`})})}),e.jsx(n,{title:"ÂÆûÈ™åÊ≠•È™§‰∏éÊï∞ÊçÆËÆ∞ÂΩï",size:"small",style:{marginBottom:16},children:e.jsx(y,{size:"small",dataSource:ne.steps,rowKey:"stepType",pagination:!1,columns:[{title:"Ê≠•È™§",dataIndex:"stepName",key:"stepName",width:120},{title:"Áä∂ÊÄÅ",dataIndex:"status",key:"status",width:100,render:s=>(s=>{const t={completed:{color:"success",text:"‚úÖ ÂÆåÊàê"},in_progress:{color:"processing",text:"üîÑ ËøõË°å‰∏≠"},failed:{color:"error",text:"‚ùå Â§±Ë¥•"},pending:{color:"default",text:"‚è≥ ÂæÖÂºÄÂßã"}}[s];return e.jsx(k,{color:t.color,children:t.text})})(s)},{title:"Êï∞ÊçÆËÆ∞ÂΩï",key:"dataRecord",width:100,render:(s,t)=>"completed"===t.status?e.jsx(p,{type:"link",size:"small",onClick:()=>be(ne,t.stepType),children:"Êü•Áúã/ÁºñËæë"}):"in_progress"===t.status?e.jsx(p,{type:"link",size:"small",onClick:()=>be(ne,t.stepType),children:"ÁªßÁª≠ËÆ∞ÂΩï"}):e.jsx(p,{type:"link",size:"small",disabled:"pending"===t.status,onClick:()=>be(ne,t.stepType),children:"ÂºÄÂßãËÆ∞ÂΩï"})},{title:"Êó∂Èó¥",key:"time",render:(e,s)=>s.startTime&&s.endTime?`${s.startTime}-${s.endTime}`:s.startTime?`${s.startTime}-`:"-"}]})}),e.jsxs(n,{title:"üìù ÂΩìÂâçÊ≠•È™§ÂÆûÊó∂ËÆ∞ÂΩï",size:"small",style:{marginBottom:16},children:[e.jsx(I,{message:"PCRÊâ©Â¢ûËøõË°å‰∏≠",description:"ÂΩìÂâçÊ≠£Âú®ËøõË°åPCRÊâ©Â¢ûÊ≠•È™§ÔºåÈ¢ÑËÆ°16:30ÂÆåÊàê„ÄÇÂ¶ÇÊúâÂºÇÂ∏∏ÊÉÖÂÜµËØ∑ÂèäÊó∂ËÆ∞ÂΩï„ÄÇ",type:"info",showIcon:!0,style:{marginBottom:12}}),e.jsxs(o,{children:[e.jsx(p,{size:"small",onClick:()=>re(!0),children:"Âø´ÈÄüËÆ∞ÂΩïÂºÇÂ∏∏"}),e.jsx(p,{size:"small",icon:e.jsx(h,{}),children:"‰∏ä‰º†ÈôÑ‰ª∂"}),e.jsx(p,{size:"small",icon:e.jsx(_,{}),children:"Ê∑ªÂä†Â§áÊ≥®"})]})]}),e.jsx(n,{title:"Ê†∑Êú¨ÂàóË°®",size:"small",children:e.jsx(y,{columns:[{title:"Ê†∑Êú¨ÁºñÂè∑",dataIndex:"sampleCode",key:"sampleCode"},{title:"Ê†∑Êú¨ÂêçÁß∞",dataIndex:"sampleName",key:"sampleName"},{title:"Ê†∑Êú¨Á±ªÂûã",dataIndex:"sampleType",key:"sampleType"},{title:"ÂΩìÂâçÁä∂ÊÄÅ",dataIndex:"status",key:"status",render:s=>e.jsx(C,{status:"completed"===s?"success":"processing"===s?"processing":"default",text:"completed"===s?"Â∑≤ÂÆåÊàê":"processing"===s?"Â§ÑÁêÜ‰∏≠":"ÂæÖÂ§ÑÁêÜ"})},{title:"Êìç‰Ωú",key:"action",render:(s,t)=>e.jsxs(o,{children:[e.jsx(p,{size:"small",type:"link",children:"Êü•ÁúãËØ¶ÊÉÖ"}),e.jsx(p,{size:"small",type:"link",children:"ËÆ∞ÂΩïÊï∞ÊçÆ"})]})}],dataSource:ne.samples,rowKey:"id",size:"small",pagination:!1})})]})}),e.jsx(z,{title:`${ce?{sample_prep:"Ê†∑Êú¨ÂâçÂ§ÑÁêÜ",nucleic_extraction:"Ê†∏ÈÖ∏ÊèêÂèñ",pcr:"PCRÊâ©Â¢û",library_prep:"ÊñáÂ∫ìÊûÑÂª∫",quantification:"ÊñáÂ∫ìÂÆöÈáè",qc:"ÊúÄÁªàQC"}[ce]:""} - Êï∞ÊçÆËÆ∞ÂΩï`,open:ae,onCancel:()=>le(!1),width:900,footer:[e.jsxs(p,{onClick:()=>{const e=K.getFieldsValue();if(pe){const s={...pe,...e,isDraft:!0};me(s);const t=`draft_${s.batchId}_${s.stepType}`;localStorage.setItem(t,JSON.stringify(s)),l.success("ËçâÁ®øÂ∑≤‰øùÂ≠ò")}},children:[e.jsx($,{}),"‰øùÂ≠òËçâÁ®ø"]},"draft"),e.jsxs(p,{type:"primary",onClick:async()=>{try{const e=await K.validateFields();if(pe){const s={...pe,...e,isDraft:!1,endTime:M().format("YYYY-MM-DD HH:mm")};if(ne){const e={...ne},s=e.steps.findIndex(e=>e.stepType===ce);if(-1!==s){e.steps[s].status="completed",e.steps[s].dataRecorded=!0,e.steps[s].endTime=M().format("HH:mm");const t=e.steps.filter(e=>"completed"===e.status).length;e.progress=Math.round(t/e.steps.length*100);const a=e.steps.find(e=>"pending"===e.status);a?(e.currentStep=a.stepName,a.status="in_progress"):(e.currentStep="Â∑≤ÂÆåÊàê",e.status="completed"),ue(je.map(s=>s.id===e.id?e:s)),de(e)}}const t=`draft_${s.batchId}_${s.stepType}`;localStorage.removeItem(t),l.success("Ê≠•È™§ËÆ∞ÂΩïÂ∑≤ÂÆåÊàê"),le(!1)}}catch(e){l.error("ËØ∑ÂÆåÂñÑÂøÖÂ°´‰ø°ÊÅØ")}},children:[e.jsx(B,{}),"ÂÆåÊàêÊ≠•È™§"]},"complete")],children:ce&&ne?e.jsxs(a,{form:K,layout:"vertical",initialValues:pe||void 0,children:[e.jsx(n,{title:"Âü∫Êú¨‰ø°ÊÅØ",size:"small",style:{marginBottom:16},children:e.jsxs(i,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"operator",label:"Êìç‰Ωú‰∫∫Âëò",rules:[{required:!0,message:"ËØ∑ËæìÂÖ•Êìç‰Ωú‰∫∫Âëò"}],children:e.jsx(v,{placeholder:"ËØ∑ËæìÂÖ•Êìç‰Ωú‰∫∫Âëò"})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"startTime",label:"ÂºÄÂßãÊó∂Èó¥",rules:[{required:!0,message:"ËØ∑ÈÄâÊã©ÂºÄÂßãÊó∂Èó¥"}],children:e.jsx(v,{placeholder:"ÂºÄÂßãÊó∂Èó¥"})})})]})}),e.jsx(n,{title:"Ê†∑Êú¨Êï∞ÊçÆËÆ∞ÂΩï",size:"small",style:{marginBottom:16},children:e.jsx(y,{size:"small",dataSource:ne.samples,rowKey:"id",pagination:!1,columns:[{title:"Ê†∑Êú¨",dataIndex:"sampleCode",key:"sampleCode",width:100},{title:"ÊµìÂ∫¶(ng/Œºl)",key:"concentration",width:120,render:(s,t)=>e.jsx(q,{size:"small",step:.1,placeholder:"ÊµìÂ∫¶",style:{width:"100%"}})},{title:"‰ΩìÁßØ(Œºl)",key:"volume",width:100,render:(s,t)=>e.jsx(q,{size:"small",step:1,placeholder:"‰ΩìÁßØ",style:{width:"100%"}})},{title:"260/280",key:"od260280",width:100,render:(s,t)=>e.jsx(q,{size:"small",step:.01,placeholder:"260/280",style:{width:"100%"}})},{title:"Êìç‰Ωú",key:"action",width:80,render:(s,t)=>e.jsx(p,{size:"small",type:"link",children:"ÈáçÊµã"})}]})}),e.jsx(n,{title:"ÂÆûÈ™åÂèÇÊï∞",size:"small",style:{marginBottom:16},children:e.jsxs(i,{gutter:16,children:[e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"temperature",label:"Ê∏©Â∫¶(‚ÑÉ)",children:e.jsx(q,{placeholder:"Ê∏©Â∫¶",style:{width:"100%"}})})}),e.jsx(r,{span:12,children:e.jsx(a.Item,{name:"duration",label:"Êó∂Èó¥(ÂàÜÈíü)",children:e.jsx(q,{placeholder:"Êó∂Èó¥",style:{width:"100%"}})})})]})}),e.jsx(n,{title:"Ë¥®ÈáèÊéßÂà∂",size:"small",style:{marginBottom:16},children:e.jsx(a.Item,{name:"qcChecks",label:"Ë¥®Ê£ÄÈ°πÁõÆ",children:e.jsx(g.Group,{children:e.jsxs(i,{children:[e.jsx(r,{span:24,children:e.jsx(g,{value:"concentration",children:"ÊµìÂ∫¶Ê£ÄÊü•: ÊâÄÊúâÊ†∑Êú¨ > 10ng/Œºl"})}),e.jsx(r,{span:24,children:e.jsx(g,{value:"purity",children:"Á∫ØÂ∫¶Ê£ÄÊü•: 260/280Âú®1.8-2.0‰πãÈó¥"})}),e.jsx(r,{span:24,children:e.jsx(g,{value:"integrity",children:"ÂÆåÊï¥ÊÄß: ÁîµÊ≥≥Ê£ÄÊµãÈÄöËøá"})})]})})})}),e.jsx(n,{title:"ÈôÑ‰ª∂",size:"small",style:{marginBottom:16},children:e.jsxs(o,{children:[e.jsx(H,{children:e.jsx(p,{icon:e.jsx(X,{}),size:"small",children:"‰∏ä‰º†ÁîµÊ≥≥Âõæ"})}),e.jsx(H,{children:e.jsx(p,{icon:e.jsx(h,{}),size:"small",children:"‰∏ä‰º†Ê£ÄÊµãÊä•Âëä"})}),e.jsx(p,{icon:e.jsx(P,{}),size:"small",children:"ÊãçÁÖß"})]})}),e.jsx(a.Item,{name:"notes",label:"Â§áÊ≥®",children:e.jsx(Q,{rows:3,placeholder:"ËØ∑ËæìÂÖ•Â§áÊ≥®‰ø°ÊÅØ"})})]}):null}),ie&&e.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,backgroundColor:"#fff",borderTop:"1px solid #d9d9d9",padding:"16px",zIndex:1e3,boxShadow:"0 -2px 8px rgba(0,0,0,0.1)"},children:e.jsxs(n,{title:`Âø´ÈÄüËÆ∞ÂΩï - ${null==ne?void 0:ne.currentStep}`,size:"small",extra:e.jsxs(o,{children:[e.jsx(p,{size:"small",onClick:()=>re(!1),children:"ÈöêËóè"}),e.jsx(p,{size:"small",icon:e.jsx(R,{}),children:"ËÆæÁΩÆ"})]}),children:[e.jsxs(i,{gutter:16,children:[e.jsx(r,{span:6,children:e.jsxs(E,{placeholder:"ÈÄâÊã©Ê†∑Êú¨",style:{width:"100%"},mode:"multiple",children:[null==ne?void 0:ne.samples.map(s=>e.jsx(O,{value:s.id,children:s.sampleCode},s.id)),e.jsx(O,{value:"all",children:"ÊâÄÊúâÊ†∑Êú¨"})]})}),e.jsx(r,{span:12,children:e.jsxs(o,{children:[e.jsx(p,{size:"small",children:"Ê∏©Â∫¶ÂºÇÂ∏∏"}),e.jsx(p,{size:"small",children:"‰ª™Âô®Êä•Ë≠¶"}),e.jsx(p,{size:"small",children:"ËØïÂâÇÈóÆÈ¢ò"}),e.jsx(p,{size:"small",children:"Êìç‰ΩúÂ§±ËØØ"})]})}),e.jsx(r,{span:6,children:e.jsxs(o,{children:[e.jsx(p,{size:"small",icon:e.jsx(P,{}),children:"ÊãçÁÖßËÆ∞ÂΩï"}),e.jsx(p,{size:"small",icon:e.jsx(B,{}),children:"Ê†áËÆ∞ÂÆåÊàê"})]})})]}),e.jsxs(i,{style:{marginTop:8},children:[e.jsx(r,{span:18,children:e.jsx(v,{placeholder:"Âø´ÈÄüÂ§áÊ≥®..."})}),e.jsx(r,{span:6,style:{paddingLeft:8},children:e.jsx(p,{type:"primary",size:"small",block:!0,children:"ËÆ∞ÂΩï"})})]})]})})]})};export{V as default};
