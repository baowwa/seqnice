import{j as e}from"./index-DyvGJ5NW.js";import{a as t}from"./react-vendor-DKSb2WWV.js";import{O as a,a as i,c as s,e as n,a2 as l,a7 as d,a3 as r,a4 as o,S as m,B as c,n as h,s as p,aR as x,W as u,ag as f,Y as D,ai as y}from"./antd-vendor-CqkZOb36.js";const{RangePicker:w}=o,{Option:C}=r,j=()=>{const[o,j]=t.useState([]),[g,S]=t.useState(!1),[T,k]=t.useState(""),[I,U]=t.useState({brand:"",dateRange:null}),[Y,b]=t.useState(!1),[N,H]=t.useState([]),v=async()=>{S(!0);try{await new Promise(e=>setTimeout(e,1e3));j([{id:"1",chipName:"NovaSeq-S4-001",brand:"Illumina",chipDD:"DD20240115001",expiryDate:"2024-12-31",firstUseTime:"2024-01-10 09:00:00",lastUseTime:"2024-01-15 18:30:00",lastEndValidHoles:64e8,totalUsageCount:5,totalSampleCount:120,washCount:3,createdAt:"2024-01-10 09:00:00",updatedAt:"2024-01-15 18:30:00"},{id:"2",chipName:"MiSeq-v3-002",brand:"Illumina",chipDD:"DD20240114002",expiryDate:"2024-11-30",firstUseTime:"2024-01-12 14:00:00",lastUseTime:"2024-01-14 22:00:00",lastEndValidHoles:2e7,totalUsageCount:3,totalSampleCount:36,washCount:2,createdAt:"2024-01-12 14:00:00",updatedAt:"2024-01-14 22:00:00"},{id:"3",chipName:"HiSeq-2500-003",brand:"Illumina",chipDD:"DD20240113003",expiryDate:"2024-10-31",firstUseTime:"2024-01-08 08:30:00",lastUseTime:"2024-01-13 20:00:00",lastEndValidHoles:32e8,totalUsageCount:4,totalSampleCount:32,washCount:2,createdAt:"2024-01-08 08:30:00",updatedAt:"2024-01-13 20:00:00"},{id:"4",chipName:"NextSeq-550-004",brand:"Illumina",chipDD:"DD20240112004",expiryDate:"2024-09-30",firstUseTime:"2024-01-09 13:00:00",lastUseTime:"2024-01-12 19:30:00",lastEndValidHoles:104e7,totalUsageCount:2,totalSampleCount:32,washCount:1,createdAt:"2024-01-09 13:00:00",updatedAt:"2024-01-12 19:30:00"},{id:"5",chipName:"NovaSeq-S2-005",brand:"Illumina",chipDD:"DD20240111005",expiryDate:"2024-08-31",firstUseTime:"2024-01-05 10:00:00",lastUseTime:"2024-01-11 16:30:00",lastEndValidHoles:264e7,totalUsageCount:6,totalSampleCount:48,washCount:4,createdAt:"2024-01-05 10:00:00",updatedAt:"2024-01-11 16:30:00"}])}catch(e){p.error("加载数据失败")}finally{S(!1)}};t.useEffect(()=>{v()},[]);const M=[{title:"芯片名称",dataIndex:"chipName",key:"chipName",width:150,fixed:"left"},{title:"品牌",dataIndex:"brand",key:"brand",width:100},{title:"芯片DD",dataIndex:"chipDD",key:"chipDD",width:140},{title:"有效期",dataIndex:"expiryDate",key:"expiryDate",width:120,render:t=>{const i=a(t).isBefore(a());return e.jsx("span",{style:{color:i?"#ff4d4f":"#52c41a"},children:a(t).format("YYYY-MM-DD")})}},{title:"第一次启用时间",dataIndex:"firstUseTime",key:"firstUseTime",width:160,render:e=>a(e).format("YYYY-MM-DD HH:mm:ss")},{title:"最后一次使用时间",dataIndex:"lastUseTime",key:"lastUseTime",width:160,render:e=>a(e).format("YYYY-MM-DD HH:mm:ss")},{title:"最后一次结束有效孔数",dataIndex:"lastEndValidHoles",key:"lastEndValidHoles",width:180,render:t=>e.jsxs("span",{style:{fontWeight:"bold",color:"#52c41a"},children:[(t/1e6).toFixed(0),"M"]})},{title:"上机次数合计",dataIndex:"totalUsageCount",key:"totalUsageCount",width:120,render:t=>e.jsxs(D,{color:"blue",style:{fontWeight:"bold"},children:[t," 次"]})},{title:"样本量合计",dataIndex:"totalSampleCount",key:"totalSampleCount",width:120,render:t=>e.jsx("span",{style:{fontWeight:"bold",color:"#1890ff"},children:t})},{title:"消洗次数",dataIndex:"washCount",key:"washCount",width:100,render:t=>e.jsxs(D,{color:"orange",style:{fontWeight:"bold"},children:[t," 次"]})},{title:"操作",key:"action",width:120,render:(t,a)=>e.jsx(c,{type:"link",size:"small",icon:e.jsx(y,{}),onClick:()=>R(a),children:"查看使用明细"})}],A=[{title:"开始时间",dataIndex:"startTime",key:"startTime",render:e=>a(e).format("YYYY-MM-DD HH:mm:ss")},{title:"结束时间",dataIndex:"endTime",key:"endTime",render:e=>a(e).format("YYYY-MM-DD HH:mm:ss")},{title:"样本数量",dataIndex:"sampleCount",key:"sampleCount",render:t=>e.jsx("span",{style:{fontWeight:"bold"},children:t})},{title:"实验科室",dataIndex:"experimentDepartment",key:"experimentDepartment"},{title:"实验人员",dataIndex:"experimentStaff",key:"experimentStaff"},{title:"清洗人",dataIndex:"washStaff",key:"washStaff"}],R=async e=>{try{await new Promise(e=>setTimeout(e,500));const t=[{id:"1",chipName:e.chipName,startTime:"2024-01-10 09:00:00",endTime:"2024-01-10 18:30:00",sampleCount:24,experimentDepartment:"基因组学部",experimentStaff:"张三",washStaff:"李四"},{id:"2",chipName:e.chipName,startTime:"2024-01-12 14:00:00",endTime:"2024-01-12 22:00:00",sampleCount:20,experimentDepartment:"外显子组学部",experimentStaff:"王五",washStaff:"赵六"},{id:"3",chipName:e.chipName,startTime:"2024-01-15 08:30:00",endTime:"2024-01-15 18:30:00",sampleCount:16,experimentDepartment:"转录组学部",experimentStaff:"孙七",washStaff:"周八"}];H(t),b(!0)}catch(t){p.error("获取使用明细失败")}},E=o.filter(e=>{const t=!T||e.chipName.toLowerCase().includes(T.toLowerCase())||e.chipDD.toLowerCase().includes(T.toLowerCase()),i=!I.brand||e.brand===I.brand,s=!I.dateRange||!I.dateRange[0]||!I.dateRange[1]||a(e.firstUseTime).isAfter(I.dateRange[0].subtract(1,"day"))&&a(e.lastUseTime).isBefore(I.dateRange[1].add(1,"day"));return t&&i&&s});return e.jsxs("div",{style:{padding:"24px"},children:[e.jsxs(i,{title:"芯片记录汇总",children:[e.jsxs(s,{gutter:16,style:{marginBottom:"16px"},children:[e.jsx(n,{span:6,children:e.jsx(l,{placeholder:"搜索芯片名称或芯片DD",prefix:e.jsx(d,{}),value:T,onChange:e=>k(e.target.value),allowClear:!0})}),e.jsx(n,{span:4,children:e.jsxs(r,{placeholder:"品牌筛选",value:I.brand,onChange:e=>U({...I,brand:e}),allowClear:!0,style:{width:"100%"},children:[e.jsx(C,{value:"Illumina",children:"Illumina"}),e.jsx(C,{value:"Thermo Fisher",children:"Thermo Fisher"}),e.jsx(C,{value:"PacBio",children:"PacBio"}),e.jsx(C,{value:"Oxford Nanopore",children:"Oxford Nanopore"})]})}),e.jsx(n,{span:6,children:e.jsx(w,{value:I.dateRange,onChange:e=>U({...I,dateRange:e}),style:{width:"100%"},placeholder:["开始时间","结束时间"],showTime:!0})}),e.jsx(n,{span:4,children:e.jsx(m,{children:e.jsx(c,{icon:e.jsx(h,{}),onClick:v,children:"刷新"})})})]}),e.jsx(s,{style:{marginBottom:"16px"},children:e.jsx(n,{span:24,children:e.jsx(m,{children:e.jsx(c,{icon:e.jsx(x,{}),onClick:()=>p.info("导出功能开发中"),children:"导出数据"})})})}),e.jsx(u,{columns:M,dataSource:E,rowKey:"id",loading:g,scroll:{x:1600},pagination:{total:E.length,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`第 ${t[0]}-${t[1]} 条/共 ${e} 条`}})]}),e.jsx(f,{title:"芯片使用明细",open:Y,onCancel:()=>b(!1),footer:[e.jsx(c,{onClick:()=>b(!1),children:"关闭"},"close")],width:1e3,children:e.jsx(u,{columns:A,dataSource:N,rowKey:"id",pagination:!1,size:"small"})})]})};export{j as default};
